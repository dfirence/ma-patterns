[
  {
    "id": "malware--54a73038-1937-4d71-a253-316e76d5413c",
    "name": "lucifer",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0532",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "impact",
          "lateral-movement",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 24,
        "items": [
          "T1012",
          "T1016",
          "T1021.002",
          "T1027.002",
          "T1033",
          "T1046",
          "T1047",
          "T1049",
          "T1053.005",
          "T1057",
          "T1059.003",
          "T1070.001",
          "T1071",
          "T1082",
          "T1105",
          "T1110.001",
          "T1140",
          "T1210",
          "T1496",
          "T1497.001",
          "T1498",
          "T1547.001",
          "T1570",
          "T1573.001"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1012::[Lucifer] can check for existing stratum cryptomining information in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\spreadCpuXmr â€“ %stratum info%.",
        "T1016::[Lucifer] can collect the IP address of a compromised host.",
        "T1021.002::[Lucifer] can infect victims by brute forcing SMB.",
        "T1027.002::[Lucifer] has used UPX packed binaries.",
        "T1033::[Lucifer] has the ability to identify the username on a compromised host.",
        "T1046::[Lucifer] can scan for open ports including TCP ports 135 and 1433.",
        "T1047::[Lucifer] can use WMI to log into remote machines for propagation.",
        "T1049::[Lucifer] can identify the IP and port numbers for all remote connections from the compromised host.",
        "T1053.005::[Lucifer] has established persistence by creating the following scheduled task schtasks /create /sc minute /mo 1 /tn QQMusic ^ /tr C:Users\\%USERPROFILE%\\Downloads\\spread.exe /F.",
        "T1057::[Lucifer] can identify the process that owns remote connections.",
        "T1059.003::[Lucifer] can issue shell commands to download and execute additional payloads.",
        "T1070.001::[Lucifer] can clear and remove event logs.",
        "T1071::[Lucifer] can use the Stratum protocol on port 10001 for communication between the cryptojacking bot and the mining server.",
        "T1082::[Lucifer] can collect the computer name, system architecture, default language, and processor frequency of a compromised host.",
        "T1105::[Lucifer] can download and execute a replica of itself using [certutil].",
        "T1110.001::[Lucifer] has attempted to brute force TCP ports 135 (RPC) and 1433 (MSSQL) with the default username or list of usernames and    passwords.",
        "T1140::[Lucifer] can decrypt its C2 address upon execution.",
        "T1210::[Lucifer] can exploit multiple vulnerabilities including EternalBlue (CVE-2017-0144) and EternalRomance (CVE-2017-0144).",
        "T1496::[Lucifer] can use system resources to mine cryptocurrency, dropping XMRig to mine Monero.",
        "T1497.001::[Lucifer] can check for specific usernames, computer names, device drivers, DLL's, and virtual devices associated with sandboxed environments and can enter an infinite loop and stop itself if any are detected.",
        "T1498::[Lucifer] can execute TCP, UDP,  and HTTP denial of service (DoS) attacks.",
        "T1547.001::[Lucifer] can persist by setting Registry key values HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic and HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic.",
        "T1570::[Lucifer] can use [certutil] for propagation on Windows hosts within intranets.",
        "T1573.001::[Lucifer] can perform a decremental-xor encryption on the initial C2 request before sending it over the wire."
      ]
    },
    "description": "[Lucifer](https://attack.mitre.org/software/S0532) is a crypto miner and DDoS hybrid malware that leverages well-known exploits to spread laterally on Windows platforms.(Citation: Unit 42 Lucifer June 2020)"
  }
]

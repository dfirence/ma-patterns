[
  {
    "id": "malware--a4f57468-fbd5-49e4-8476-52088220b92d",
    "name": "zebrocy",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0251",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 30,
        "items": [
          "T1012",
          "T1016",
          "T1027.002",
          "T1033",
          "T1037.001",
          "T1041",
          "T1047",
          "T1049",
          "T1053.005",
          "T1056.004",
          "T1057",
          "T1059.003",
          "T1070.004",
          "T1071.001",
          "T1071.003",
          "T1074.001",
          "T1082",
          "T1083",
          "T1105",
          "T1113",
          "T1119",
          "T1120",
          "T1124",
          "T1132.001",
          "T1135",
          "T1140",
          "T1547.001",
          "T1555.003",
          "T1560",
          "T1573.002"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "apt28"
        ]
      },
      "procedures": [
        "T1012::[Zebrocy] executes the reg query command to obtain information in the Registry.",
        "T1016::[Zebrocy] runs the ipconfig /all command.",
        "T1027.002::[Zebrocy]'s Delphi variant was packed with UPX.",
        "T1033::[Zebrocy] gets the username from the system.",
        "T1037.001::[Zebrocy] performs persistence with a logon script via adding to the Registry key HKCU\\Environment\\UserInitMprLogonScript.",
        "T1041::[Zebrocy] has exfiltrated data to the designated C2 server using HTTP POST requests.",
        "T1047::One variant of [Zebrocy] uses WMI queries to gather information.",
        "T1049::[Zebrocy] uses netstat -aon to gather network connection information.",
        "T1053.005::[Zebrocy] has a command to create a scheduled task for persistence.",
        "T1056.004::[Zebrocy] installs an application-defined Windows hook to get notified when a network drive has been attached, so it can then use the hook to call its RecordToFile file stealing method.",
        "T1057::[Zebrocy] uses the tasklist and wmic process get Capture, ExecutablePath commands to gather the processes running on the system.",
        "T1059.003::[Zebrocy] uses cmd.exe to execute commands on the system.",
        "T1070.004::[Zebrocy] has a command to delete files and directories.",
        "T1071.001::[Zebrocy] uses HTTP for C2.",
        "T1071.003::[Zebrocy] uses SMTP and POP3 for C2.",
        "T1074.001::[Zebrocy] stores all collected information in a single file before exfiltration.",
        "T1082::[Zebrocy] collects the OS version, computer name and serial number for the storage volume C:\\. [Zebrocy] also runs the systeminfo command to gather system information.",
        "T1083::[Zebrocy] searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. [Zebrocy] also runs the echo %APPDATA% command to list the contents of the directory.",
        "T1105::[Zebrocy] obtains additional code to execute on the victim's machine, including the downloading of a secondary payload.",
        "T1113::A variant of [Zebrocy] captures screenshots of the victim’s machine in JPEG and BMP format.",
        "T1119::[Zebrocy] scans the system and automatically collects files with the following extensions: .doc, .docx, ,.xls, .xlsx, .pdf, .pptx, .rar, .zip, .jpg, .jpeg, .bmp, .tiff, .kum, .tlg, .sbx, .cr, .hse, .hsf, and .lhz.",
        "T1120::[Zebrocy] enumerates information about connected storage devices.",
        "T1124::[Zebrocy] gathers the current time zone and date information from the system.",
        "T1132.001::[Zebrocy] has used URL/Percent Encoding on data exfiltrated via HTTP POST requests.",
        "T1135::[Zebrocy] identifies network drives when they are added to victim systems.",
        "T1140::[Zebrocy] decodes its secondary payload and writes it to the victim’s machine. [Zebrocy] also uses AES and XOR to decrypt strings and payloads.",
        "T1547.001::[Zebrocy] creates an entry in a Registry Run key for the malware to execute on startup.",
        "T1555.003::[Zebrocy] has the capability to upload dumper tools that extract credentials from web browsers and store them in database files.",
        "T1560::[Zebrocy]  has used a method similar to RC4 as well as AES for encryption and hexadecimal for encoding data before exfiltration.",
        "T1573.002::[Zebrocy] uses SSL and AES ECB for encrypting C2 communications."
      ]
    },
    "description": "[Zebrocy](https://attack.mitre.org/software/S0251) is a Trojan that has been used by [APT28](https://attack.mitre.org/groups/G0007) since at least November 2015. The malware comes in several programming language variants, including C++, Delphi, AutoIt, C#, VB.NET, and Golang. (Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: CISA Zebrocy Oct 2020) "
  }
]

[
  {
    "id": "malware--2a59a237-1530-4d55-91f9-2aebf961cc37",
    "name": "macos.osaminer",
    "aliases": "none",
    "platforms": "macos",
    "malware_id": "S1048",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 10,
        "items": [
          "T1027.008",
          "T1027.009",
          "T1057",
          "T1059.002",
          "T1082",
          "T1105",
          "T1497.001",
          "T1543.001",
          "T1562.001",
          "T1569.001"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1027.008::[macOS.OSAMiner] has used run-only Applescripts, a compiled and stripped version of [AppleScript], to remove human readable indicators to evade detection.",
        "T1027.009::[macOS.OSAMiner] has embedded [Stripped Payloads] within another run-only [Stripped Payloads].",
        "T1057::[macOS.OSAMiner] has used `ps ax | grep <name> | grep -v grep | ...` and `ps ax | grep -E...` to conduct process discovery.",
        "T1059.002::[macOS.OSAMiner] has used `osascript` to call itself via the `do shell script` command in the [Launch Agent] `.plist` file.",
        "T1082::[macOS.OSAMiner] can gather the device serial number and has checked to ensure there is enough disk space using the Unix utility `df`.",
        "T1105::[macOS.OSAMiner] has used `curl` to download a [Stripped Payloads] from a public facing adversary-controlled webpage.",
        "T1497.001::[macOS.OSAMiner] can parse the output of the native `system_profiler` tool to determine if the machine is running with 4 cores.",
        "T1543.001::[macOS.OSAMiner] has placed a [Stripped Payloads] with a `plist` extension in the [Launch Agent]'s folder.",
        "T1562.001::[macOS.OSAMiner] has searched for the Activity Monitor process in the System Events process list and kills the process if running. [macOS.OSAMiner] also searches the operating system's `install.log` for apps matching its hardcoded list, killing all matching process names.",
        "T1569.001::[macOS.OSAMiner] has used `launchctl` to restart the [Launch Agent]."
      ]
    },
    "description": "[macOS.OSAMiner](https://attack.mitre.org/software/S1048) is a Monero mining trojan that was first observed in 2018; security researchers assessed [macOS.OSAMiner](https://attack.mitre.org/software/S1048) may have been circulating since at least 2015. [macOS.OSAMiner](https://attack.mitre.org/software/S1048) is known for embedding one run-only AppleScript into another, which helped the malware evade full analysis for five years due to a lack of Apple event (AEVT) analysis tools.(Citation: SentinelLabs reversing run-only applescripts 2021)(Citation: VMRay OSAMiner dynamic analysis 2021)"
  }
]

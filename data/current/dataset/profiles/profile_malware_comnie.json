[
  {
    "id": "malware--f4c80d39-ce10-4f74-9b50-a7e3f5df1f2e",
    "name": "comnie",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0244",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 7,
        "items": [
          "collection",
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 19,
        "items": [
          "T1007",
          "T1016",
          "T1018",
          "T1027",
          "T1027.001",
          "T1049",
          "T1057",
          "T1059.003",
          "T1059.005",
          "T1071.001",
          "T1082",
          "T1087.001",
          "T1102.002",
          "T1119",
          "T1218.011",
          "T1518.001",
          "T1547.001",
          "T1547.009",
          "T1573.001"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1007::[Comnie] runs the command: net start >> %TEMP%\\info.dat on a victim.",
        "T1016::[Comnie] uses ipconfig /all and route PRINT to identify network adapter and interface information.",
        "T1018::[Comnie] runs the net view command",
        "T1027.001::[Comnie] appends a total of 64MB of garbage data to a file to deter any security products in place that may be scanning files on disk.",
        "T1027::[Comnie] uses RC4 and Base64 to obfuscate strings.",
        "T1049::[Comnie] executes the netstat -ano command.",
        "T1057::[Comnie] uses the tasklist to view running processes on the victim’s machine.",
        "T1059.003::[Comnie] executes BAT scripts.",
        "T1059.005::[Comnie] executes VBS scripts.",
        "T1071.001::[Comnie] uses HTTP for C2 communication.",
        "T1082::[Comnie] collects the hostname of the victim machine.",
        "T1087.001::[Comnie] uses the net user command.",
        "T1102.002::[Comnie] uses blogs and third-party sites (GitHub, tumbler, and BlogSpot) to avoid DNS-based blocking of their communication to the command and control server.",
        "T1119::[Comnie] executes a batch script to store discovery information in %TEMP%\\info.dat and then uploads the temporarily file to the remote C2 server.",
        "T1218.011::[Comnie] uses Rundll32 to load a malicious DLL.",
        "T1518.001::[Comnie] attempts to detect several anti-virus products.",
        "T1547.001::[Comnie] achieves persistence by adding a shortcut of itself to the startup path in the Registry.",
        "T1547.009::[Comnie] establishes persistence via a .lnk file in the victim’s startup path.",
        "T1573.001::[Comnie] encrypts command and control communications with RC4."
      ]
    },
    "description": "[Comnie](https://attack.mitre.org/software/S0244) is a remote backdoor which has been used in attacks in East Asia. (Citation: Palo Alto Comnie)"
  }
]

[
  {
    "id": "malware--6cd07296-14aa-403d-9229-6343d03d4752",
    "name": "cuba",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0625",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "impact",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 23,
        "items": [
          "T1007",
          "T1016",
          "T1027",
          "T1027.002",
          "T1036.005",
          "T1049",
          "T1056.001",
          "T1057",
          "T1059.001",
          "T1059.003",
          "T1070.004",
          "T1082",
          "T1083",
          "T1105",
          "T1106",
          "T1134",
          "T1135",
          "T1486",
          "T1489",
          "T1543.003",
          "T1564.003",
          "T1614.001",
          "T1620"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1007::[Cuba] can query service status using QueryServiceStatusEx function.",
        "T1016::[Cuba] can retrieve the ARP cache from the local system by using GetIpNetTable.",
        "T1027.002::[Cuba] has a packed payload when delivered.",
        "T1027::[Cuba] has used multiple layers of obfuscation to avoid analysis, including its Base64 encoded payload.",
        "T1036.005::[Cuba] has been disguised as legitimate 360 Total Security Antivirus and OpenVPN programs.",
        "T1049::[Cuba] can use the function GetIpNetTable to recover the last connections to the victim's machine.",
        "T1056.001::[Cuba] logs keystrokes via polling by using GetKeyState and VkKeyScan functions.",
        "T1057::[Cuba] can enumerate processes running on a victim's machine.",
        "T1059.001::[Cuba] has been dropped onto systems and used for lateral movement via obfuscated PowerShell scripts.",
        "T1059.003::[Cuba] has used cmd.exe /c and batch files for execution.",
        "T1070.004::[Cuba] can use the command cmd.exe /c del to delete its artifacts from the system.",
        "T1082::[Cuba] can enumerate local drives, disk type, and disk free space.",
        "T1083::[Cuba] can enumerate files by using a variety of functions.",
        "T1105::[Cuba] can download files from its C2 server.",
        "T1106::[Cuba] has used several built-in API functions for discovery like GetIpNetTable and NetShareEnum.",
        "T1134::[Cuba] has used SeDebugPrivilege and AdjustTokenPrivileges to elevate privileges.",
        "T1135::[Cuba] can discover shared resources using the NetShareEnum API call.",
        "T1486::[Cuba] has the ability to encrypt system data and add the \".cuba\" extension to encrypted files.",
        "T1489::[Cuba] has a hardcoded list of services and processes to terminate.",
        "T1543.003::[Cuba] can modify services by using the OpenService and ChangeServiceConfig functions.",
        "T1564.003::[Cuba] has executed hidden PowerShell windows.",
        "T1614.001::[Cuba] can check if Russian language is installed on the infected machine by using the function GetKeyboardLayoutList.",
        "T1620::[Cuba] loaded the payload into memory using PowerShell."
      ]
    },
    "description": "\n[Cuba](https://attack.mitre.org/software/S0625) is a Windows-based ransomware family that has been used against financial institutions, technology, and logistics organizations in North and South America as well as Europe since at least December 2019.(Citation: McAfee Cuba April 2021)"
  }
]

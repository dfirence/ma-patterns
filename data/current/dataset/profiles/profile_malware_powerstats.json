[
  {
    "id": "malware--e8545794-b98c-492b-a5b3-4b5a02682e37",
    "name": "powerstats",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0223",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 8,
        "items": [
          "collection",
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 27,
        "items": [
          "T1005",
          "T1016",
          "T1027.001",
          "T1027.010",
          "T1029",
          "T1033",
          "T1036.004",
          "T1047",
          "T1053.005",
          "T1057",
          "T1059.001",
          "T1059.005",
          "T1059.007",
          "T1070.004",
          "T1082",
          "T1087.001",
          "T1090.002",
          "T1105",
          "T1113",
          "T1132.001",
          "T1140",
          "T1218.005",
          "T1518.001",
          "T1559.001",
          "T1559.002",
          "T1562.001",
          "T1573.002"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "muddywater"
        ]
      },
      "procedures": [
        "T1005::[POWERSTATS] can upload files from compromised hosts.",
        "T1016::[POWERSTATS] can retrieve IP, network adapter configuration information, and domain from compromised hosts.",
        "T1027.001::[POWERSTATS] has used useless code blocks to counter analysis.",
        "T1027.010::[POWERSTATS] uses character replacement, [PowerShell] environment variables, and XOR encoding to obfuscate code. [POWERSTATS]'s backdoor code is a multi-layer obfuscated, encoded, and compressed blob.",
        "T1029::[POWERSTATS] can sleep for a given number of seconds.",
        "T1033::[POWERSTATS] has the ability to identify the username on the compromised host.",
        "T1036.004::[POWERSTATS] has created a scheduled task named \"MicrosoftEdge\" to establish persistence.",
        "T1047::[POWERSTATS] can use WMI queries to retrieve data from compromised hosts.",
        "T1053.005::[POWERSTATS] has established persistence through a scheduled task using the command ”C:\\Windows\\system32\\schtasks.exe” /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR “c:\\Windows\\system32\\wscript.exe C:\\Windows\\temp\\Windows.vbe”.",
        "T1057::[POWERSTATS] has used get_tasklist to discover processes on the compromised host.",
        "T1059.001::[POWERSTATS] uses PowerShell for obfuscation and execution.",
        "T1059.005::[POWERSTATS] can use VBScript (VBE) code for execution.",
        "T1059.007::[POWERSTATS] can use JavaScript code for execution.",
        "T1070.004::[POWERSTATS] can delete all files on the C:\\, D:\\, E:\\ and, F:\\ drives using [PowerShell] Remove-Item commands.",
        "T1082::[POWERSTATS] can retrieve OS name/architecture and computer/domain name information from compromised hosts.",
        "T1087.001::[POWERSTATS] can retrieve usernames from compromised hosts.",
        "T1090.002::[POWERSTATS] has connected to C2 servers through proxies.",
        "T1105::[POWERSTATS] can retrieve and execute additional [PowerShell] payloads from the C2 server.",
        "T1113::[POWERSTATS] can retrieve screenshots from compromised hosts.",
        "T1132.001::[POWERSTATS] encoded C2 traffic with base64.",
        "T1140::[POWERSTATS] can deobfuscate the main backdoor code.",
        "T1218.005::[POWERSTATS] can use Mshta.exe to execute additional payloads on compromised hosts.",
        "T1518.001::[POWERSTATS] has detected security tools.",
        "T1559.001::[POWERSTATS] can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.",
        "T1559.002::[POWERSTATS] can use DDE to execute additional payloads on compromised hosts.",
        "T1562.001::[POWERSTATS] can disable Microsoft Office Protected View by changing Registry keys.",
        "T1573.002::[POWERSTATS] has encrypted C2 traffic with RSA."
      ]
    },
    "description": "[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)"
  }
]

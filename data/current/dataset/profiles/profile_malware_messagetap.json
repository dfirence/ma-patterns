[
  {
    "id": "malware--9b19d6b4-cfcb-492f-8ca8-8449e7331573",
    "name": "messagetap",
    "aliases": "none",
    "platforms": "linux",
    "malware_id": "S0443",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 4,
        "items": [
          "collection",
          "credential-access",
          "defense-evasion",
          "discovery"
        ]
      },
      "techniques": {
        "count": 8,
        "items": [
          "T1040",
          "T1049",
          "T1070.004",
          "T1074.001",
          "T1083",
          "T1119",
          "T1140",
          "T1560.003"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "apt41"
        ]
      },
      "procedures": [
        "T1040::[MESSAGETAP] uses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers. It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.",
        "T1049::After loading the keyword and phone data files, [MESSAGETAP] begins monitoring all network connections to and from the victim server.",
        "T1070.004::Once loaded into memory, [MESSAGETAP] deletes the keyword_parm.txt and parm.txt configuration files from disk.",
        "T1074.001::[MESSAGETAP] stored targeted SMS messages that matched its target list in CSV files on the compromised system.",
        "T1083::[MESSAGETAP] checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.",
        "T1119::[MESSAGETAP] checks two files, keyword_parm.txt and parm.txt, for instructions on how to target and save data parsed and extracted from SMS message data from the network traffic. If an SMS message contained either a phone number, IMSI number, or keyword that matched the predefined list, it is saved to a CSV file for later theft by the threat actor.",
        "T1140::After checking for the existence of two files, keyword_parm.txt and parm.txt, [MESSAGETAP] XOR decodes and read the contents of the files.",
        "T1560.003::[MESSAGETAP] has XOR-encrypted and stored contents of SMS messages that matched its target list."
      ]
    },
    "description": "[MESSAGETAP](https://attack.mitre.org/software/S0443) is a data mining malware family deployed by [APT41](https://attack.mitre.org/groups/G0096) into telecommunications networks to monitor and save SMS traffic from specific phone numbers, IMSI numbers, or that contain specific keywords. (Citation: FireEye MESSAGETAP October 2019)"
  }
]

[
  {
    "id": "malware--86b92f6c-9c05-4c51-b361-4c7bb13e21a1",
    "name": "konni",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0356",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "initial-access",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 39,
        "items": [
          "T1005",
          "T1016",
          "T1027",
          "T1027.002",
          "T1033",
          "T1036.004",
          "T1036.005",
          "T1041",
          "T1048.003",
          "T1049",
          "T1056.001",
          "T1057",
          "T1059.001",
          "T1059.003",
          "T1059.007",
          "T1070.004",
          "T1071.001",
          "T1082",
          "T1083",
          "T1105",
          "T1106",
          "T1112",
          "T1113",
          "T1115",
          "T1132.001",
          "T1134.002",
          "T1134.004",
          "T1140",
          "T1204.002",
          "T1218.011",
          "T1543.003",
          "T1546.015",
          "T1547.001",
          "T1547.009",
          "T1548.002",
          "T1555.003",
          "T1560",
          "T1566.001",
          "T1573.001"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1005::[KONNI] has stored collected information and discovered processes in a tmp file.",
        "T1016::[KONNI] can collect the IP address from the victim’s machine.",
        "T1027.002::[KONNI] has been packed for obfuscation.",
        "T1027::[KONNI] is heavily obfuscated and includes encrypted configuration files.",
        "T1033::[KONNI] can collect the username from the victim’s machine.",
        "T1036.004::[KONNI] has pretended to be the xmlProv Network Provisioning service.",
        "T1036.005::[KONNI] has created a shortcut called \"Anti virus service.lnk\" in an apparent attempt to masquerade as a legitimate file.",
        "T1041::[KONNI] has sent data and files to its C2 server.",
        "T1048.003::[KONNI] has used FTP to exfiltrate reconnaissance data out.",
        "T1049::[KONNI] has used net session on the victim's machine.",
        "T1056.001::[KONNI] has the capability to perform keylogging.",
        "T1057::[KONNI] has used the command cmd /c tasklist to get a snapshot of the current processes on the target machine.",
        "T1059.001::[KONNI] used PowerShell to download and execute a specific 64-bit version of the malware.",
        "T1059.003::[KONNI] has used cmd.exe to execute arbitrary commands on the infected host across different stages of the infection chain.",
        "T1059.007::[KONNI] has executed malicious JavaScript code.",
        "T1070.004::[KONNI] can delete files.",
        "T1071.001::[KONNI] has used HTTP POST for C2.",
        "T1082::[KONNI] can gather the OS version, architecture information, connected drives, hostname, RAM size, and disk space information from the victim’s machine and has used cmd /c systeminfo command to get a snapshot of the current system state of the target machine.",
        "T1083::A version of [KONNI] searches for filenames created with a previous version of the malware, suggesting different versions targeted the same victims and the versions may work together.",
        "T1105::[KONNI] can download files and execute them on the victim’s machine.",
        "T1106::[KONNI] has hardcoded API calls within its functions to use on the victim's machine.",
        "T1112::[KONNI] has modified registry keys of ComSysApp, Svchost, and xmlProv on the machine to gain persistence.",
        "T1113::[KONNI] can take screenshots of the victim’s machine.",
        "T1115::[KONNI] had a feature to steal data from the clipboard.",
        "T1132.001::[KONNI] has used a custom base64 key to encode stolen data before exfiltration.",
        "T1134.002::[KONNI] has duplicated the token of a high integrity process to spawn an instance of cmd.exe under an impersonated user.",
        "T1134.004::[KONNI] has used parent PID spoofing to spawn a new `cmd` process using `CreateProcessW` and a handle to `Taskmgr.exe`.",
        "T1140::[KONNI] has used certutil to download and decode base64 encoded strings and has also devoted a custom section to performing all the components of the deobfuscation process.",
        "T1204.002::[KONNI] has relied on a victim to enable malicious macros within an attachment delivered via email.",
        "T1218.011::[KONNI] has used Rundll32 to execute its loader for privilege escalation purposes.",
        "T1543.003::[KONNI] has registered itself as a service using its export function.",
        "T1546.015::[KONNI] has modified ComSysApp service to load the malicious DLL payload.",
        "T1547.001::A version of [KONNI] has dropped a Windows shortcut into the Startup folder to establish persistence.",
        "T1547.009::A version of [KONNI] drops a Windows shortcut on the victim’s machine to establish persistence.",
        "T1548.002::[KONNI] has bypassed UAC by performing token impersonation as well as an RPC-based method, this included bypassing UAC set to “AlwaysNotify\".",
        "T1555.003::[KONNI] can steal profiles (containing credential information) from Firefox, Chrome, and Opera.",
        "T1560::[KONNI] has encrypted data and files prior to exfiltration.",
        "T1566.001::[KONNI] has been delivered via spearphishing campaigns through a malicious Word document.",
        "T1573.001::[KONNI] has used AES to encrypt C2 traffic."
      ]
    },
    "description": "[KONNI](https://attack.mitre.org/software/S0356) is a remote access tool that security researchers assess has been used by North Korean cyber actors since at least 2014. [KONNI](https://attack.mitre.org/software/S0356) has significant code overlap with the [NOKKI](https://attack.mitre.org/software/S0353) malware family, and has been linked to several suspected North Korean campaigns targeting political organizations in Russia, East Asia, Europe and the Middle East; there is some evidence potentially linking [KONNI](https://attack.mitre.org/software/S0356) to [APT37](https://attack.mitre.org/groups/G0067).(Citation: Talos Konni May 2017)(Citation: Unit 42 NOKKI Sept 2018)(Citation: Unit 42 Nokki Oct 2018)(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021)"
  }
]

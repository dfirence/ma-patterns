[
  {
    "id": "malware--a5528622-3a8a-4633-86ce-8cdaf8423858",
    "name": "finfisher",
    "aliases": "none",
    "platforms": "windows|android",
    "malware_id": "S0182",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "collection",
          "credential-access",
          "defense-evasion",
          "discovery",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 23,
        "items": [
          "T1012",
          "T1027",
          "T1027.001",
          "T1027.002",
          "T1036.005",
          "T1055.001",
          "T1056.004",
          "T1057",
          "T1070.001",
          "T1082",
          "T1083",
          "T1113",
          "T1134.001",
          "T1140",
          "T1497.001",
          "T1518.001",
          "T1542.003",
          "T1543.003",
          "T1547.001",
          "T1548.002",
          "T1574.001",
          "T1574.002",
          "T1574.013"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "dark-caracal"
        ]
      },
      "procedures": [
        "T1012::[FinFisher] queries Registry values as part of its anti-sandbox checks.",
        "T1027.001::[FinFisher] contains junk code in its functions in an effort to confuse disassembly programs.",
        "T1027.002::A [FinFisher] variant uses a custom packer.",
        "T1027::[FinFisher] is heavily obfuscated in many ways, including through the use of spaghetti code in its functions in an effort to confuse disassembly programs. It also uses a custom XOR algorithm to obfuscate code.",
        "T1036.005::[FinFisher] renames one of its .dll files to uxtheme.dll in an apparent attempt to masquerade as a legitimate file.",
        "T1055.001::[FinFisher] injects itself into various processes depending on whether it is low integrity or high integrity.",
        "T1056.004::[FinFisher] hooks processes by modifying IAT pointers to CreateWindowEx.",
        "T1057::[FinFisher] checks its parent process for indications that it is running in a sandbox setup.",
        "T1070.001::[FinFisher] clears the system event logs using  OpenEventLog/ClearEventLog APIs .",
        "T1082::[FinFisher] checks if the victim OS is 32 or 64-bit.",
        "T1083::[FinFisher] enumerates directories and scans for certain files.",
        "T1113::[FinFisher] takes a screenshot of the screen and displays it on top of all other windows for few seconds in an apparent attempt to hide some messages showed by the system during the setup process.",
        "T1134.001::[FinFisher] uses token manipulation with NtFilterToken as part of UAC bypass.",
        "T1140::[FinFisher] extracts and decrypts stage 3 malware, which is stored in encrypted resources.",
        "T1497.001::[FinFisher] obtains the hardware device list and checks if the MD5 of the vendor ID is equal to a predefined list in order to check for sandbox/virtualized environments.",
        "T1518.001::[FinFisher] probes the system to check for antimalware processes.",
        "T1542.003::Some [FinFisher] variants incorporate an MBR rootkit.",
        "T1543.003::[FinFisher] creates a new Windows service with the malicious executable for persistence.",
        "T1547.001::[FinFisher] establishes persistence by creating the Registry key HKCU\\Software\\Microsoft\\Windows\\Run.",
        "T1548.002::[FinFisher] performs UAC bypass.",
        "T1574.001::A [FinFisher] variant uses DLL search order hijacking.",
        "T1574.002::[FinFisher] uses DLL side-loading to load malicious programs.",
        "T1574.013::[FinFisher] has used the KernelCallbackTable to hijack the execution flow of a process by replacing the __fnDWORD function with the address of a created [Asynchronous Procedure Call] stub routine."
      ]
    },
    "description": "[FinFisher](https://attack.mitre.org/software/S0182) is a government-grade commercial surveillance spyware reportedly sold exclusively to government agencies for use in targeted and lawful criminal investigations. It is heavily obfuscated and uses multiple anti-analysis techniques. It has other variants including [Wingbird](https://attack.mitre.org/software/S0176). (Citation: FinFisher Citation) (Citation: Microsoft SIR Vol 21) (Citation: FireEye FinSpy Sept 2017) (Citation: Securelist BlackOasis Oct 2017) (Citation: Microsoft FinFisher March 2018)"
  }
]

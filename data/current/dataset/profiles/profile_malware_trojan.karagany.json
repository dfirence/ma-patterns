[
  {
    "id": "malware--82cb34ba-02b5-432b-b2d2-07f55cbf674d",
    "name": "trojan.karagany",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0094",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 8,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 22,
        "items": [
          "T1003",
          "T1010",
          "T1016",
          "T1027",
          "T1027.002",
          "T1033",
          "T1049",
          "T1055.003",
          "T1056.001",
          "T1057",
          "T1059.003",
          "T1070.004",
          "T1071.001",
          "T1074.001",
          "T1082",
          "T1083",
          "T1105",
          "T1113",
          "T1497.001",
          "T1547.001",
          "T1555.003",
          "T1573.002"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "dragonfly"
        ]
      },
      "procedures": [
        "T1003::[Trojan.Karagany] can dump passwords and save them into \\ProgramData\\Mail\\MailAg\\pwds.txt.",
        "T1010::[Trojan.Karagany] can monitor the titles of open windows to identify specific keywords.",
        "T1016::[Trojan.Karagany] can gather information on the network configuration of a compromised host.",
        "T1027.002::[Trojan.Karagany] samples sometimes use common binary packers such as UPX and Aspack on top of a custom Delphi binary packer.",
        "T1027::[Trojan.Karagany] can base64 encode and AES-128-CBC encrypt data prior to transmission.",
        "T1033::[Trojan.Karagany] can gather information about the user on a compromised host.",
        "T1049::[Trojan.Karagany] can use [netstat] to collect a list of network connections.",
        "T1055.003::[Trojan.Karagany] can inject a suspended thread of its own process into a new process and initiate via the ResumeThread API.",
        "T1056.001::[Trojan.Karagany] can capture keystrokes on a compromised host.",
        "T1057::[Trojan.Karagany] can use [Tasklist] to collect a list of running tasks.",
        "T1059.003::[Trojan.Karagany] can perform reconnaissance commands on a victim machine via a cmd.exe process.",
        "T1070.004::[Trojan.Karagany] has used plugins with a self-delete capability.",
        "T1071.001::[Trojan.Karagany] can communicate with C2 via HTTP POST requests.",
        "T1074.001::[Trojan.Karagany] can create directories to store plugin output and stage data for exfiltration.",
        "T1082::[Trojan.Karagany] can capture information regarding the victim's OS, security, and hardware configuration.",
        "T1083::[Trojan.Karagany] can enumerate files and directories on a compromised host.",
        "T1105::[Trojan.Karagany] can upload, download, and execute files on the victim.",
        "T1113::[Trojan.Karagany] can take a desktop screenshot and save the file into \\ProgramData\\Mail\\MailAg\\shot.png.",
        "T1497.001::[Trojan.Karagany] can detect commonly used and generic virtualization platforms based primarily on drivers and file paths.",
        "T1547.001::[Trojan.Karagany] can create a link to itself in the Startup folder to automatically start itself upon system restart.",
        "T1555.003::[Trojan.Karagany] can steal data and credentials from browsers.",
        "T1573.002::[Trojan.Karagany] can secure C2 communications with SSL and TLS."
      ]
    },
    "description": "[Trojan.Karagany](https://attack.mitre.org/software/S0094) is a modular remote access tool used for recon and linked to [Dragonfly](https://attack.mitre.org/groups/G0035). The source code for [Trojan.Karagany](https://attack.mitre.org/software/S0094) originated from Dream Loader malware which was leaked in 2010 and sold on underground forums. (Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019)(Citation: Dragos DYMALLOY )"
  }
]

[
  {
    "id": "malware--be25c1c0-1590-4219-a3d5-6f31799d1d1b",
    "name": "funnydream",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S1044",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 37,
        "items": [
          "T1001",
          "T1005",
          "T1010",
          "T1012",
          "T1016",
          "T1018",
          "T1025",
          "T1027",
          "T1033",
          "T1036.004",
          "T1041",
          "T1047",
          "T1055.001",
          "T1056.001",
          "T1057",
          "T1059.003",
          "T1070",
          "T1070.004",
          "T1074.001",
          "T1082",
          "T1083",
          "T1090",
          "T1095",
          "T1105",
          "T1106",
          "T1113",
          "T1119",
          "T1120",
          "T1124",
          "T1218.011",
          "T1518.001",
          "T1543.003",
          "T1547.001",
          "T1559.001",
          "T1560.002",
          "T1560.003",
          "T1572"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1001::[FunnyDream] can send compressed and obfuscated packets to C2.",
        "T1005::[FunnyDream] can upload files from victims' machines.",
        "T1010::[FunnyDream] has the ability to discover application windows via execution of `EnumWindows`.",
        "T1012::[FunnyDream] can check `Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings` to extract the `ProxyServer` string.",
        "T1016::[FunnyDream] can parse the `ProxyServer` string in the Registry to discover http proxies.",
        "T1018::[FunnyDream] can collect information about hosts on the victim network.",
        "T1025::The [FunnyDream] FilePakMonitor component has the ability to collect files from removable devices.",
        "T1027::[FunnyDream] can Base64 encode its C2 address stored in a template binary with the `xyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw_-` or\n`xyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw_=` character sets.",
        "T1033::[FunnyDream] has the ability to gather user information from the targeted system using `whoami/upn&whoami/fqdn&whoami/logonid&whoami/all`.",
        "T1036.004::[FunnyDream] has used a service named `WSearch` for execution.",
        "T1041::[FunnyDream] can execute commands, including gathering user information, and send the results to C2.",
        "T1047::[FunnyDream] can use WMI to open a Windows command shell on a remote machine.",
        "T1055.001::The [FunnyDream] FilepakMonitor component can inject into the Bka.exe process using the `VirtualAllocEx`, `WriteProcessMemory` and `CreateRemoteThread` APIs to load the DLL component.",
        "T1056.001::The [FunnyDream] Keyrecord component can capture keystrokes.",
        "T1057::[FunnyDream] has the ability to discover processes, including `Bka.exe` and `BkavUtil.exe`.",
        "T1059.003::[FunnyDream] can use `cmd.exe` for execution on remote hosts.",
        "T1070.004::[FunnyDream] can delete files including its dropper component.",
        "T1070::[FunnyDream] has the ability to clean traces of malware deployment.",
        "T1074.001::[FunnyDream] can stage collected information including screen captures and logged keystrokes locally.",
        "T1082::[FunnyDream] can enumerate all logical drives on a targeted machine.",
        "T1083::[FunnyDream] can identify files with .doc, .docx, .ppt, .pptx, .xls, .xlsx, and .pdf extensions and specific timestamps for collection.",
        "T1090::[FunnyDream] can identify and use configured proxies in a compromised network for C2 communication.",
        "T1095::[FunnyDream] can communicate with C2 over TCP and UDP.",
        "T1105::[FunnyDream] can download additional files onto a compromised host.",
        "T1106::[FunnyDream] can use Native API for defense evasion, discovery, and collection.",
        "T1113::The [FunnyDream] ScreenCap component can take screenshots on a compromised host.",
        "T1119::[FunnyDream] can monitor files for changes and automatically collect them.",
        "T1120::The [FunnyDream] FilepakMonitor component can detect removable drive insertion.",
        "T1124::[FunnyDream] can check system time to help determine when changes were made to specified files.",
        "T1218.011::[FunnyDream] can use `rundll32` for execution of its components.",
        "T1518.001::[FunnyDream] can identify the processes for Bkav antivirus.",
        "T1543.003::[FunnyDream] has established persistence by running `sc.exe` and by setting the `WSearch` service to run automatically.",
        "T1547.001::[FunnyDream] can use a Registry Run Key and the Startup folder to establish persistence.",
        "T1559.001::[FunnyDream] can use com objects identified with `CLSID_ShellLink`(`IShellLink` and `IPersistFile`) and `WScript.Shell`(`RegWrite` method) to enable persistence mechanisms.",
        "T1560.002::[FunnyDream] has compressed collected files with zLib.",
        "T1560.003::[FunnyDream] has compressed collected files with zLib and encrypted them using an XOR operation with the string key from the command line or `qwerasdf` if the command line argument doesnâ€™t contain the key. File names are obfuscated using XOR with the same key as the compressed file content.",
        "T1572::[FunnyDream] can connect to HTTP proxies via TCP to create a tunnel to C2."
      ]
    },
    "description": "[FunnyDream](https://attack.mitre.org/software/S1044) is a backdoor with multiple components that was used during the [FunnyDream](https://attack.mitre.org/campaigns/C0007) campaign since at least 2019, primarily for execution and exfiltration.(Citation: Bitdefender FunnyDream Campaign November 2020)"
  }
]

[
  {
    "id": "malware--ba09b86c-1c40-4ff1-bda0-0d8c4ca35997",
    "name": "ramsay",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0458",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "initial-access",
          "lateral-movement",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 39,
        "items": [
          "T1005",
          "T1014",
          "T1016",
          "T1025",
          "T1027",
          "T1027.003",
          "T1036",
          "T1036.005",
          "T1039",
          "T1046",
          "T1049",
          "T1053.005",
          "T1055.001",
          "T1057",
          "T1059.005",
          "T1071.001",
          "T1074.001",
          "T1080",
          "T1082",
          "T1083",
          "T1091",
          "T1106",
          "T1113",
          "T1119",
          "T1120",
          "T1132.001",
          "T1135",
          "T1140",
          "T1203",
          "T1204.002",
          "T1546.010",
          "T1547.001",
          "T1548.002",
          "T1559.001",
          "T1559.002",
          "T1560.001",
          "T1560.003",
          "T1566.001",
          "T1574.001"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1005::[Ramsay] can collect Microsoft Word documents from the target's file system, as well as .txt, .doc, and .xls files from the Internet Explorer cache.",
        "T1014::[Ramsay] has included a rootkit to evade defenses.",
        "T1016::[Ramsay] can use [ipconfig] and [Arp] to collect network configuration information, including routing information and ARP tables.",
        "T1025::[Ramsay] can collect data from removable media and stage it for exfiltration.",
        "T1027.003::[Ramsay] has PE data embedded within JPEG files contained within Word documents.",
        "T1027::[Ramsay] has base64-encoded its portable executable and hidden itself under a JPG header. [Ramsay] can also embed information within document footers.",
        "T1036.005::[Ramsay] has masqueraded as a 7zip installer.",
        "T1036::[Ramsay] has masqueraded as a JPG image file.",
        "T1039::[Ramsay] can collect data from network drives and stage it for exfiltration.",
        "T1046::[Ramsay] can scan for systems that are vulnerable to the EternalBlue exploit.",
        "T1049::[Ramsay] can use netstat to enumerate network connections.",
        "T1053.005::[Ramsay] can schedule tasks via the Windows COM API to maintain persistence.",
        "T1055.001::[Ramsay] can use ImprovedReflectiveDLLInjection to deploy components.",
        "T1057::[Ramsay] can gather a list of running processes by using [Tasklist].",
        "T1059.005::[Ramsay] has included embedded Visual Basic scripts in malicious documents.",
        "T1071.001::[Ramsay] has used HTTP for C2.",
        "T1074.001::[Ramsay] can stage data prior to exfiltration in %APPDATA%\\Microsoft\\UserSetting and %APPDATA%\\Microsoft\\UserSetting\\MediaCache.",
        "T1080::[Ramsay] can spread itself by infecting other portable executable files on networks shared drives.",
        "T1082::[Ramsay] can detect system information--including disk names, total space, and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.",
        "T1083::[Ramsay] can collect directory and file lists.",
        "T1091::[Ramsay] can spread itself by infecting other portable executable files on removable drives.",
        "T1106::[Ramsay] can use Windows API functions such as WriteFile, CloseHandle, and GetCurrentHwProfile during its collection and file storage operations. [Ramsay] can execute its embedded components via CreateProcessA and ShellExecute.",
        "T1113::[Ramsay] can take screenshots every 30 seconds as well as when an external removable storage device is connected.",
        "T1119::[Ramsay] can conduct an initial scan for Microsoft Word documents on the local system, removable media, and connected network drives, before tagging and collecting them. It can continue tagging documents to collect with follow up scans.",
        "T1120::[Ramsay] can scan for removable media which may contain documents for collection.",
        "T1132.001::[Ramsay] has used base64 to encode its C2 traffic.",
        "T1135::[Ramsay] can scan for network drives which may contain documents for collection.",
        "T1140::[Ramsay] can extract its agent from the body of a malicious document.",
        "T1203::[Ramsay] has been embedded in documents exploiting CVE-2017-0199, CVE-2017-11882, and CVE-2017-8570.",
        "T1204.002::[Ramsay] has been executed through malicious e-mail attachments.",
        "T1546.010::[Ramsay] can insert itself into the address space of other applications using the AppInit DLL Registry key.",
        "T1547.001::[Ramsay] has created Registry Run keys to establish persistence.",
        "T1548.002::[Ramsay] can use [UACMe] for privilege escalation.",
        "T1559.001::[Ramsay] can use the Windows COM API to schedule tasks and maintain persistence.",
        "T1559.002::[Ramsay] has been delivered using OLE objects in malicious documents.",
        "T1560.001::[Ramsay] can compress and archive collected files using WinRAR.",
        "T1560.003::[Ramsay] can store collected documents in a custom container after encrypting and compressing them using RC4 and WinRAR.",
        "T1566.001::[Ramsay] has been distributed through spearphishing emails with malicious attachments.",
        "T1574.001::[Ramsay] can hijack outdated Windows application dependencies with malicious versions of its own DLL payload."
      ]
    },
    "description": "[Ramsay](https://attack.mitre.org/software/S0458) is an information stealing malware framework designed to collect and exfiltrate sensitive documents, including from air-gapped systems. Researchers have identified overlaps between [Ramsay](https://attack.mitre.org/software/S0458) and the [Darkhotel](https://attack.mitre.org/groups/G0012)-associated Retro malware.(Citation: Eset Ramsay May 2020)(Citation: Antiy CERT Ramsay April 2020)"
  }
]

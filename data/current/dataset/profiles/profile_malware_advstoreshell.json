[
  {
    "id": "malware--fb575479-14ef-41e9-bfab-0b7cf10bec73",
    "name": "advstoreshell",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0045",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 23,
        "items": [
          "T1012",
          "T1027",
          "T1029",
          "T1041",
          "T1056.001",
          "T1057",
          "T1059.003",
          "T1070.004",
          "T1071.001",
          "T1074.001",
          "T1082",
          "T1083",
          "T1106",
          "T1112",
          "T1120",
          "T1132.001",
          "T1218.011",
          "T1546.015",
          "T1547.001",
          "T1560",
          "T1560.003",
          "T1573.001",
          "T1573.002"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "apt28"
        ]
      },
      "procedures": [
        "T1012::[ADVSTORESHELL] can enumerate registry keys.",
        "T1027::Most of the strings in [ADVSTORESHELL] are encrypted with an XOR-based algorithm; some strings are also encrypted with 3DES and reversed. API function names are also reversed, presumably to avoid detection in memory.",
        "T1029::[ADVSTORESHELL] collects, compresses, encrypts, and exfiltrates data to the C2 server every 10 minutes.",
        "T1041::[ADVSTORESHELL] exfiltrates data over the same channel used for C2.",
        "T1056.001::[ADVSTORESHELL] can perform keylogging.",
        "T1057::[ADVSTORESHELL] can list running processes.",
        "T1059.003::[ADVSTORESHELL] can create a remote shell and run a given command.",
        "T1070.004::[ADVSTORESHELL] can delete files and directories.",
        "T1071.001::[ADVSTORESHELL] connects to port 80 of a C2 server using Wininet API. Data is exchanged via HTTP POSTs.",
        "T1074.001::[ADVSTORESHELL] stores output from command execution in a .dat file in the %TEMP% directory.",
        "T1082::[ADVSTORESHELL] can run [Systeminfo] to gather information about the victim.",
        "T1083::[ADVSTORESHELL] can list files and directories.",
        "T1106::[ADVSTORESHELL] is capable of starting a process using CreateProcess.",
        "T1112::[ADVSTORESHELL] is capable of setting and deleting Registry values.",
        "T1120::[ADVSTORESHELL] can list connected devices.",
        "T1132.001::C2 traffic from [ADVSTORESHELL] is encrypted, then encoded with Base64 encoding.",
        "T1218.011::[ADVSTORESHELL] has used rundll32.exe in a Registry value to establish persistence.",
        "T1546.015::Some variants of [ADVSTORESHELL] achieve persistence by registering the payload as a Shell Icon Overlay handler COM object.",
        "T1547.001::[ADVSTORESHELL] achieves persistence by adding itself to the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.",
        "T1560.003::[ADVSTORESHELL] compresses output data generated by command execution with a custom implementation of the Lempel–Ziv–Welch (LZW) algorithm.",
        "T1560::[ADVSTORESHELL] encrypts with the 3DES algorithm and a hardcoded key prior to exfiltration.",
        "T1573.001::A variant of [ADVSTORESHELL] encrypts some C2 with 3DES.",
        "T1573.002::A variant of [ADVSTORESHELL] encrypts some C2 with RSA."
      ]
    },
    "description": "[ADVSTORESHELL](https://attack.mitre.org/software/S0045) is a spying backdoor that has been used by [APT28](https://attack.mitre.org/groups/G0007) from at least 2012 to 2016. It is generally used for long-term espionage and is deployed on targets deemed interesting after a reconnaissance phase. (Citation: Kaspersky Sofacy) (Citation: ESET Sednit Part 2)"
  }
]

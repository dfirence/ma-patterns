[
  {
    "id": "malware--ade37ada-14af-4b44-b36c-210eec255d53",
    "name": "valak",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0476",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "initial-access",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 34,
        "items": [
          "T1008",
          "T1012",
          "T1016",
          "T1027",
          "T1027.002",
          "T1027.011",
          "T1033",
          "T1041",
          "T1047",
          "T1053.005",
          "T1057",
          "T1059.001",
          "T1059.007",
          "T1071.001",
          "T1082",
          "T1087.001",
          "T1087.002",
          "T1104",
          "T1105",
          "T1112",
          "T1113",
          "T1114.002",
          "T1119",
          "T1132.001",
          "T1140",
          "T1204.002",
          "T1218.010",
          "T1518.001",
          "T1552.002",
          "T1555.004",
          "T1559.002",
          "T1564.004",
          "T1566.001",
          "T1566.002"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "ta551"
        ]
      },
      "procedures": [
        "T1008::[Valak] can communicate over multiple C2 hosts.",
        "T1012::[Valak] can use the Registry for code updates and to collect credentials.",
        "T1016::[Valak] has the ability to identify the domain and the MAC and IP addresses of an infected machine.",
        "T1027.002::[Valak] has used packed DLL payloads.",
        "T1027.011::[Valak] has the ability to store information regarding the C2 server and downloads in the Registry key HKCU\\Software\\ApplicationContainer\\Appsw64.",
        "T1027::[Valak] has the ability to base64 encode and XOR encrypt strings.",
        "T1033::[Valak] can gather information regarding the user.",
        "T1041::[Valak] has the ability to exfiltrate data over the C2 channel.",
        "T1047::[Valak] can use wmic process call create in a scheduled task to launch plugins and for execution.",
        "T1053.005::[Valak] has used scheduled tasks to execute additional payloads and to gain persistence on a compromised host.",
        "T1057::[Valak] has the ability to enumerate running processes on a compromised host.",
        "T1059.001::[Valak] has used PowerShell to download additional modules.",
        "T1059.007::[Valak] can execute JavaScript containing configuration data for establishing persistence.",
        "T1071.001::[Valak] has used HTTP in communications with C2.",
        "T1082::[Valak] can determine the Windows version and computer name on a compromised host.",
        "T1087.001::[Valak] has the ability to enumerate local admin accounts.",
        "T1087.002::[Valak] has the ability to enumerate domain admin accounts.",
        "T1104::[Valak] can download additional modules and malware capable of using separate C2 channels.",
        "T1105::[Valak] has downloaded a variety of modules and payloads to the compromised host, including [IcedID] and NetSupport Manager RAT-based malware.",
        "T1112::[Valak] has the ability to modify the Registry key HKCU\\Software\\ApplicationContainer\\Appsw64 to store information regarding the C2 server and downloads.",
        "T1113::[Valak] has the ability to take screenshots on a compromised host.",
        "T1114.002::[Valak] can collect sensitive mailing information from Exchange servers, including credentials and the domain certificate of an enterprise.",
        "T1119::[Valak] can download a module to search for and build a report of harvested credential data.",
        "T1132.001::[Valak] has returned C2 data as encoded ASCII.",
        "T1140::[Valak] has the ability to decode and decrypt downloaded files.",
        "T1204.002::[Valak] has been executed via Microsoft Word documents containing malicious macros.",
        "T1218.010::[Valak] has used regsvr32.exe to launch malicious DLLs.",
        "T1518.001::[Valak] can determine if a compromised host has security products installed.",
        "T1552.002::[Valak] can use the clientgrabber module to steal e-mail credentials from the Registry.",
        "T1555.004::[Valak] can use a .NET compiled module named exchgrabber to enumerate credentials from the Credential Manager.",
        "T1559.002::[Valak] can execute tasks via OLE.",
        "T1564.004::[Valak] has the ability save and execute files as alternate data streams (ADS).",
        "T1566.001::[Valak] has been delivered via spearphishing e-mails with password protected ZIP files.",
        "T1566.002::[Valak] has been delivered via malicious links in e-mail."
      ]
    },
    "description": "[Valak](https://attack.mitre.org/software/S0476) is a multi-stage modular malware that can function as a standalone information stealer or downloader, first observed in 2019 targeting enterprises in the US and Germany.(Citation: Cybereason Valak May 2020)(Citation: Unit 42 Valak July 2020)"
  }
]

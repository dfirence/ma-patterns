[
  {
    "id": "malware--958b5d06-8bb0-4c5b-a2e7-0130fe654ac7",
    "name": "grandoreiro",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0531",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "initial-access",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 42,
        "items": [
          "T1010",
          "T1016",
          "T1027",
          "T1027.001",
          "T1027.011",
          "T1033",
          "T1036.005",
          "T1041",
          "T1056.001",
          "T1057",
          "T1059.005",
          "T1070.004",
          "T1071.001",
          "T1082",
          "T1087.003",
          "T1102.001",
          "T1102.002",
          "T1105",
          "T1106",
          "T1112",
          "T1115",
          "T1124",
          "T1140",
          "T1176",
          "T1185",
          "T1189",
          "T1204.001",
          "T1204.002",
          "T1218.007",
          "T1222.001",
          "T1497.001",
          "T1518.001",
          "T1539",
          "T1547.001",
          "T1547.009",
          "T1548.002",
          "T1555.003",
          "T1562.001",
          "T1562.004",
          "T1566.002",
          "T1568.002",
          "T1573.002"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1010::[Grandoreiro] can identify installed security tools based on window names.",
        "T1016::[Grandoreiro] can determine the IP and physical location of the compromised host via IPinfo.",
        "T1027.001::[Grandoreiro] has added BMP images to the resources section of its Portable Executable (PE) file increasing each binary to at least 300MB in size.",
        "T1027.011::[Grandoreiro] can store its configuration in the Registry at `HKCU\\Software\\` under frequently changing names including %USERNAME% and ToolTech-RM.",
        "T1027::The [Grandoreiro] payload has been delivered encrypted with a custom XOR-based algorithm and also as a base64-encoded ZIP file.",
        "T1033::[Grandoreiro] can collect the username from the victim's machine.",
        "T1036.005::[Grandoreiro] has named malicious browser extensions and update files to appear legitimate.",
        "T1041::[Grandoreiro] can send data it retrieves to the C2 server.",
        "T1056.001::[Grandoreiro] can log keystrokes on the victim's machine.",
        "T1057::[Grandoreiro] can identify installed security tools based on process names.",
        "T1059.005::[Grandoreiro] can use VBScript to execute malicious code.",
        "T1070.004::[Grandoreiro] can delete .LNK files created in the Startup folder.",
        "T1071.001::[Grandoreiro] has the ability to use HTTP in C2 communications.",
        "T1082::[Grandoreiro] can collect the computer name and OS version from a compromised host.",
        "T1087.003::[Grandoreiro] can parse Outlook .pst files to extract e-mail addresses.",
        "T1102.001::[Grandoreiro] can obtain C2 information from Google Docs.",
        "T1102.002::[Grandoreiro] can utilize web services including Google sites to send and receive C2 data.",
        "T1105::[Grandoreiro] can download its second stage from a hardcoded URL within the loader's code.",
        "T1106::[Grandoreiro] can execute through the WinExec API.",
        "T1112::[Grandoreiro] can modify the Registry to store its configuration at `HKCU\\Software\\` under frequently changing names including %USERNAME% and ToolTech-RM.",
        "T1115::[Grandoreiro] can capture clipboard data from a compromised host.",
        "T1124::[Grandoreiro] can determine the time on the victim machine via IPinfo.",
        "T1140::[Grandoreiro] can decrypt its encrypted internal strings.",
        "T1176::[Grandoreiro] can use malicious browser extensions to steal cookies and other user information.",
        "T1185::[Grandoreiro] can monitor browser activity for online banking actions and display full-screen overlay images to block user access to the intended site or present additional data fields.",
        "T1189::[Grandoreiro] has used compromised websites and Google Ads to bait victims into downloading its installer.",
        "T1204.001::[Grandoreiro] has used malicious links to gain execution on victim machines.",
        "T1204.002::[Grandoreiro] has infected victims via malicious attachments.",
        "T1218.007::[Grandoreiro] can use MSI files to execute DLLs.",
        "T1222.001::[Grandoreiro] can modify the binary ACL to prevent security tools from running.",
        "T1497.001::[Grandoreiro] can detect VMWare via its I/O port and Virtual PC via the vpcext instruction.",
        "T1518.001::[Grandoreiro] can list installed security products including the Trusteer and Diebold Warsaw GAS Tecnologia online banking protections.",
        "T1539::[Grandoreiro] can steal the victim's cookies to use for duplicating the active session from another device.",
        "T1547.001::[Grandoreiro] can use run keys and create link files in the startup folder for persistence.",
        "T1547.009::[Grandoreiro] can write or modify browser shortcuts to enable launching of malicious browser extensions.",
        "T1548.002::[Grandoreiro] can bypass UAC by registering as the default handler for .MSC files.",
        "T1555.003::[Grandoreiro] can steal cookie data and credentials from Google Chrome.",
        "T1562.001::[Grandoreiro] can hook APIs, kill processes, break file system paths, and change ACLs to prevent security tools from running.",
        "T1562.004::[Grandoreiro] can block the Deibold Warsaw GAS Tecnologia security tool at the firewall level.",
        "T1566.002::[Grandoreiro] has been spread via malicious links embedded in e-mails.",
        "T1568.002::[Grandoreiro] can use a DGA for hiding C2 addresses, including use of an algorithm with a user-specific key that changes daily.",
        "T1573.002::[Grandoreiro] can use SSL in C2 communication."
      ]
    },
    "description": "[Grandoreiro](https://attack.mitre.org/software/S0531) is a banking trojan written in Delphi that was first observed in 2016 and uses a Malware-as-a-Service (MaaS) business model. [Grandoreiro](https://attack.mitre.org/software/S0531) has confirmed victims in Brazil, Mexico, Portugal, and Spain.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: ESET Grandoreiro April 2020)"
  }
]

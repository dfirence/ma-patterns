[
  {
    "id": "malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8",
    "name": "darktortilla",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S1066",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "initial-access",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 28,
        "items": [
          "T1007",
          "T1016.001",
          "T1027",
          "T1036",
          "T1047",
          "T1055.001",
          "T1056.001",
          "T1057",
          "T1059.003",
          "T1071.001",
          "T1082",
          "T1102",
          "T1105",
          "T1106",
          "T1112",
          "T1115",
          "T1140",
          "T1204.002",
          "T1497.001",
          "T1497.003",
          "T1518.001",
          "T1547.001",
          "T1547.004",
          "T1559.001",
          "T1564",
          "T1566.001",
          "T1574.012",
          "T1622"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1007::[DarkTortilla] can retrieve information about a compromised system's running services.",
        "T1016.001::[DarkTortilla] can check for internet connectivity by issuing HTTP GET requests.",
        "T1027::[DarkTortilla] has been obfuscated with the DeepSea .NET and ConfuserEx code obfuscators.",
        "T1036::[DarkTortilla]'s payload has been renamed `PowerShellInfo.exe`.",
        "T1047::[DarkTortilla] can use WMI queries to obtain system information.",
        "T1055.001::[DarkTortilla] can use a .NET-based DLL named `RunPe6` for process injection.",
        "T1056.001::[DarkTortilla] can download a keylogging module.",
        "T1057::[DarkTortilla] can enumerate a list of running processes on a compromised system.",
        "T1059.003::[DarkTortilla] can use `cmd.exe` to add registry keys for persistence.",
        "T1071.001::[DarkTortilla] has used HTTP and HTTPS for C2.",
        "T1082::[DarkTortilla] can obtain system information by querying the `Win32_ComputerSystem`, `Win32_BIOS`, `Win32_MotherboardDevice`, `Win32_PnPEntity`, and `Win32_DiskDrive` WMI objects.",
        "T1102::[DarkTortilla] can retrieve its primary payload from public sites such as Pastebin and Textbin.",
        "T1105::[DarkTortilla] can download additional packages for keylogging, cryptocurrency mining, and other capabilities; it can also retrieve malicious payloads such as [Agent Tesla], AsyncRat, [NanoCore], RedLine, [Cobalt Strike], and Metasploit.",
        "T1106::[DarkTortilla] can use a variety of API calls for persistence and defense evasion.",
        "T1112::[DarkTortilla] has modified registry keys for persistence.",
        "T1115::[DarkTortilla] can download a clipboard information stealer module.",
        "T1140::[DarkTortilla] can decrypt its payload and associated configuration elements using the Rijndael cipher.",
        "T1204.002::[DarkTortilla] has relied on a user to open a malicious document or archived file delivered via email for initial execution.",
        "T1497.001::[DarkTortilla] can search a compromised system's running processes and services to detect Hyper-V, QEMU, Virtual PC, Virtual Box, and VMware, as well as Sandboxie.",
        "T1497.003::[DarkTortilla] can implement the `kernel32.dll` Sleep function to delay execution for up to 300 seconds before implementing persistence or processing an addon package.",
        "T1518.001::[DarkTortilla] can check for the Kaspersky Anti-Virus suite.",
        "T1547.001::[DarkTortilla] has established persistence via the `Software\\Microsoft\\Windows NT\\CurrentVersion\\Run` registry key and by creating a .lnk shortcut file in the Windows startup folder.",
        "T1547.004::[DarkTortilla] has established persistence via the `Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon` registry key.",
        "T1559.001::[DarkTortilla] has used the `WshShortcut` COM object to create a .lnk shortcut file in the Windows startup folder.",
        "T1564::[DarkTortilla] has used `%HiddenReg%` and `%HiddenKey%` as part of its persistence via the Windows registry.",
        "T1566.001::[DarkTortilla] has been distributed via spearphishing emails containing archive attachments, with file types such as .iso, .zip, .img, .dmg, and .tar, as well as through malicious documents.",
        "T1574.012::[DarkTortilla] can detect profilers by verifying the `COR_ENABLE_PROFILING` environment variable is present and active.",
        "T1622::[DarkTortilla] can detect debuggers by using functions such as `DebuggerIsAttached` and `DebuggerIsLogging`. [DarkTortilla] can also detect profilers by verifying the `COR_ENABLE_PROFILING` environment variable is present and active."
      ]
    },
    "description": "[DarkTortilla](https://attack.mitre.org/software/S1066) is a highly configurable .NET-based crypter that has been possibly active since at least August 2015. [DarkTortilla](https://attack.mitre.org/software/S1066) has been used to deliver popular information stealers, RATs, and payloads such as [Agent Tesla](https://attack.mitre.org/software/S0331), AsyncRat, [NanoCore](https://attack.mitre.org/software/S0336), RedLine, [Cobalt Strike](https://attack.mitre.org/software/S0154), and Metasploit.(Citation: Secureworks DarkTortilla Aug 2022)"
  }
]

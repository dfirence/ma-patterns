[
  {
    "id": "malware--f3f1fbed-7e29-49cb-8579-4a378f858deb",
    "name": "waterbear",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0579",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 14,
        "items": [
          "T1012",
          "T1027",
          "T1027.005",
          "T1049",
          "T1055",
          "T1055.003",
          "T1057",
          "T1105",
          "T1106",
          "T1112",
          "T1140",
          "T1518.001",
          "T1562.006",
          "T1574.002"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "blacktech"
        ]
      },
      "procedures": [
        "T1012::[Waterbear] can query the Registry key \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\MTxOCI\" to see if the value `OracleOcilib` exists.",
        "T1027.005::[Waterbear] can scramble functions not to be executed again with random values.",
        "T1027::[Waterbear] has used RC4 encrypted shellcode and encrypted functions.",
        "T1049::[Waterbear] can use API hooks on `GetExtendedTcpTable` to retrieve a table containing a list of TCP endpoints available to the application.",
        "T1055.003::[Waterbear] can use thread injection to inject shellcode into the process of security software.",
        "T1055::[Waterbear] can inject decrypted shellcode into the LanmanServer service.",
        "T1057::[Waterbear] can identify the process for a specific security product.",
        "T1105::[Waterbear] can receive and load executables from remote C2 servers.",
        "T1106::[Waterbear] can leverage API functions for execution.",
        "T1112::[Waterbear] has deleted certain values from the Registry to load a malicious DLL.",
        "T1140::[Waterbear] has the ability to decrypt its RC4 encrypted payload for execution.",
        "T1518.001::[Waterbear] can find the presence of a specific security software.",
        "T1562.006::[Waterbear] can hook the ZwOpenProcess and GetExtendedTcpTable APIs called by the process of a security product to hide PIDs and TCP records from detection.",
        "T1574.002::[Waterbear] has used DLL side loading to import and load a malicious DLL loader."
      ]
    },
    "description": "[Waterbear](https://attack.mitre.org/software/S0579) is modular malware attributed to [BlackTech](https://attack.mitre.org/groups/G0098) that has been used primarily for lateral movement, decrypting, and triggering payloads and is capable of hiding network behaviors.(Citation: Trend Micro Waterbear December 2019)"
  }
]

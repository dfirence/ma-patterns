[
  {
    "id": "malware--92b55426-109f-4d93-899f-1833ce91ff90",
    "name": "mosquito",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0256",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 17,
        "items": [
          "T1016",
          "T1027",
          "T1027.011",
          "T1033",
          "T1047",
          "T1057",
          "T1059.001",
          "T1059.003",
          "T1070.004",
          "T1105",
          "T1106",
          "T1112",
          "T1218.011",
          "T1518.001",
          "T1546.015",
          "T1547.001",
          "T1573.001"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "turla"
        ]
      },
      "procedures": [
        "T1016::[Mosquito] uses the ipconfig command.",
        "T1027.011::[Mosquito] stores configuration values under the Registry key HKCU\\Software\\Microsoft\\[dllname].",
        "T1027::[Mosquito]’s installer is obfuscated with a custom crypter to obfuscate the installer.",
        "T1033::[Mosquito] runs whoami on the victim’s machine.",
        "T1047::[Mosquito]'s installer uses WMI to search for antivirus display names.",
        "T1057::[Mosquito] runs tasklist to obtain running processes.",
        "T1059.001::[Mosquito] can launch PowerShell Scripts.",
        "T1059.003::[Mosquito] executes cmd.exe and uses a pipe to read the results and send back the output to the C2 server.",
        "T1070.004::[Mosquito] deletes files using DeleteFileW API call.",
        "T1105::[Mosquito] can upload and download files to the victim.",
        "T1106::[Mosquito] leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.",
        "T1112::[Mosquito] can modify Registry keys under HKCU\\Software\\Microsoft\\[dllname] to store configuration values. [Mosquito] also modifies Registry keys under HKCR\\CLSID\\...\\InprocServer32 with a path to the launcher.",
        "T1218.011::[Mosquito]'s launcher uses rundll32.exe in a Registry Key value to start the main backdoor capability.",
        "T1518.001::[Mosquito]'s installer searches the Registry and system to see if specific antivirus tools are installed on the system.",
        "T1546.015::[Mosquito] uses COM hijacking as a method of persistence.",
        "T1547.001::[Mosquito] establishes persistence under the Registry key HKCU\\Software\\Run auto_update.",
        "T1573.001::[Mosquito] uses a custom encryption algorithm, which consists of XOR and a stream that is similar to the Blum Blum Shub algorithm."
      ]
    },
    "description": "[Mosquito](https://attack.mitre.org/software/S0256) is a Win32 backdoor that has been used by [Turla](https://attack.mitre.org/groups/G0010). [Mosquito](https://attack.mitre.org/software/S0256) is made up of three parts: the installer, the launcher, and the backdoor. The main backdoor is called CommanderDLL and is launched by the loader program. (Citation: ESET Turla Mosquito Jan 2018)"
  }
]

[
  {
    "id": "malware--bf48e7f8-752c-4ce8-bf8f-748edacd8fa6",
    "name": "sunspot",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0562",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "defense-evasion",
          "discovery",
          "execution",
          "impact",
          "initial-access",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 11,
        "items": [
          "T1027",
          "T1036.005",
          "T1057",
          "T1070.004",
          "T1083",
          "T1106",
          "T1134",
          "T1140",
          "T1195.002",
          "T1480",
          "T1565.001"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "apt29"
        ]
      },
      "procedures": [
        "T1027::[SUNSPOT] encrypted log entries it collected with the stream cipher RC4 using a hard-coded key. It also uses AES128-CBC encrypted blobs for [SUNBURST] source code and data extracted from the SolarWinds Orion <MsBuild.exe process.",
        "T1036.005::[SUNSPOT] was identified on disk with a filename of taskhostsvc.exe and it created an encrypted log file at C:\\Windows\\Temp\\vmware-vmdmp.log.",
        "T1057::[SUNSPOT] monitored running processes for instances of MsBuild.exe by hashing the name of each running process and comparing it to the corresponding value 0x53D525. It also extracted command-line arguments and individual arguments from the running MsBuild.exe process to identify the directory path of the Orion software Visual Studio solution.",
        "T1070.004::Following the successful injection of [SUNBURST], [SUNSPOT] deleted a temporary file it created named InventoryManager.bk after restoring the original SolarWinds Orion source code to the software library.",
        "T1083::[SUNSPOT] enumerated the Orion software Visual Studio solution directory path.",
        "T1106::[SUNSPOT] used Windows API functions such as MoveFileEx and NtQueryInformationProcess as part of the [SUNBURST] injection process.",
        "T1134::[SUNSPOT] modified its security token to grants itself debugging privileges by adding SeDebugPrivilege.",
        "T1140::[SUNSPOT] decrypts [SUNBURST], which was stored in AES128-CBC encrypted blobs.",
        "T1195.002::[SUNSPOT] malware was designed and used to insert [SUNBURST] into software builds of the SolarWinds Orion IT management product.",
        "T1480::[SUNSPOT] only replaces SolarWinds Orion source code if the MD5 checksums of both the original source code file and backdoored replacement source code match hardcoded values.",
        "T1565.001::[SUNSPOT] created a copy of the SolarWinds Orion software source file with a .bk extension to backup the original content, wrote [SUNBURST] using the same filename but with a .tmp extension, and then moved [SUNBURST] using MoveFileEx to the original filename with a .cs extension so it could be compiled within Orion software."
      ]
    },
    "description": "[SUNSPOT](https://attack.mitre.org/software/S0562) is an implant that injected the [SUNBURST](https://attack.mitre.org/software/S0559) backdoor into the SolarWinds Orion software update framework. It was used by [APT29](https://attack.mitre.org/groups/G0016) since at least February 2020.(Citation: CrowdStrike SUNSPOT Implant January 2021) "
  }
]

[
  {
    "id": "malware--3c18ad16-9eaf-4649-984e-68551bff0d47",
    "name": "squirrelwaffle",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S1030",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 7,
        "items": [
          "collection",
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "initial-access"
        ]
      },
      "techniques": {
        "count": 21,
        "items": [
          "T1016",
          "T1027",
          "T1027.002",
          "T1033",
          "T1041",
          "T1059.001",
          "T1059.003",
          "T1059.005",
          "T1071.001",
          "T1082",
          "T1105",
          "T1132.001",
          "T1140",
          "T1204.001",
          "T1204.002",
          "T1218.010",
          "T1218.011",
          "T1497",
          "T1560.003",
          "T1566.001",
          "T1566.002"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1016::[Squirrelwaffle] has collected the victimâ€™s external IP address.",
        "T1027.002::[Squirrelwaffle] has been packed with a custom packer to hide payloads.",
        "T1027::[Squirrelwaffle] has been obfuscated with a XOR-based algorithm.",
        "T1033::[Squirrelwaffle] can collect the user name from a compromised host.",
        "T1041::[Squirrelwaffle] has exfiltrated victim data using HTTP POST requests to its C2 servers.",
        "T1059.001::[Squirrelwaffle] has used PowerShell to execute its payload.",
        "T1059.003::[Squirrelwaffle] has used `cmd.exe` for execution.",
        "T1059.005::[Squirrelwaffle] has used malicious VBA macros in Microsoft Word documents and Excel spreadsheets that execute an `AutoOpen` subroutine.",
        "T1071.001::[Squirrelwaffle] has used HTTP POST requests for C2 communications.",
        "T1082::[Squirrelwaffle] has gathered victim computer information and configurations.",
        "T1105::[Squirrelwaffle] has downloaded and executed additional encoded payloads.",
        "T1132.001::[Squirrelwaffle] has encoded its communications to C2 servers using Base64.",
        "T1140::[Squirrelwaffle] has decrypted files and payloads using a XOR-based algorithm.",
        "T1204.001::[Squirrelwaffle] has relied on victims to click on a malicious link send via phishing campaigns.",
        "T1204.002::[Squirrelwaffle] has relied on users enabling malicious macros within Microsoft Excel and Word attachments.",
        "T1218.010::[Squirrelwaffle] has been executed using `regsvr32.exe`.",
        "T1218.011::[Squirrelwaffle] has been executed using `rundll32.exe`.",
        "T1497::[Squirrelwaffle] has contained a hardcoded list of IP addresses to block that belong to sandboxes and analysis platforms.",
        "T1560.003::[Squirrelwaffle] has encrypted collected data using a XOR-based algorithm.",
        "T1566.001::[Squirrelwaffle] has been distributed via malicious Microsoft Office documents within spam emails.",
        "T1566.002::[Squirrelwaffle] has been distributed through phishing emails containing a malicious URL."
      ]
    },
    "description": "[Squirrelwaffle](https://attack.mitre.org/software/S1030) is a loader that was first seen in September 2021. It has been used in spam email campaigns to deliver additional malware such as [Cobalt Strike](https://attack.mitre.org/software/S0154) and the [QakBot](https://attack.mitre.org/software/S0650) banking trojan.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021)"
  }
]

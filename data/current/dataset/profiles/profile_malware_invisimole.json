[
  {
    "id": "malware--47afe41c-4c08-485e-b062-c3bd209a1cce",
    "name": "invisimole",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0260",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "impact",
          "lateral-movement",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 72,
        "items": [
          "T1001.003",
          "T1005",
          "T1007",
          "T1008",
          "T1010",
          "T1012",
          "T1016",
          "T1025",
          "T1027",
          "T1027.005",
          "T1033",
          "T1036.004",
          "T1036.005",
          "T1046",
          "T1053.005",
          "T1055",
          "T1055.002",
          "T1055.004",
          "T1055.015",
          "T1056.001",
          "T1057",
          "T1059.003",
          "T1059.007",
          "T1068",
          "T1070.004",
          "T1070.005",
          "T1070.006",
          "T1071.001",
          "T1071.004",
          "T1074.001",
          "T1080",
          "T1082",
          "T1083",
          "T1087.001",
          "T1090.001",
          "T1090.002",
          "T1095",
          "T1105",
          "T1106",
          "T1112",
          "T1113",
          "T1119",
          "T1123",
          "T1124",
          "T1125",
          "T1132.002",
          "T1135",
          "T1140",
          "T1203",
          "T1204.002",
          "T1210",
          "T1218.002",
          "T1218.011",
          "T1480.001",
          "T1490",
          "T1497.001",
          "T1518",
          "T1518.001",
          "T1543.003",
          "T1547.001",
          "T1547.009",
          "T1548.002",
          "T1559.001",
          "T1560.001",
          "T1560.002",
          "T1560.003",
          "T1562.004",
          "T1564.001",
          "T1564.003",
          "T1569.002",
          "T1573.001",
          "T1574.001"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1001.003::[InvisiMole] can mimic HTTP protocol with custom HTTP “verbs” HIDE, ZVVP, and NOP.",
        "T1005::[InvisiMole] can collect data from the system, and can monitor changes in specified directories.",
        "T1007::[InvisiMole] can obtain running services on the victim.",
        "T1008::[InvisiMole] has been configured with several servers available for alternate C2 communications.",
        "T1010::[InvisiMole] can enumerate windows and child windows on a compromised host.",
        "T1012::[InvisiMole] can enumerate Registry values, keys, and data.",
        "T1016::[InvisiMole] gathers information on the IP forwarding table, MAC address, configured proxy, and network SSID.",
        "T1025::[InvisiMole] can collect jpeg files from connected MTP devices.",
        "T1027.005::[InvisiMole] has undergone regular technical improvements in an attempt to evade detection.",
        "T1027::[InvisiMole] avoids analysis by encrypting all strings, internal files, configuration data and by using a custom executable format.",
        "T1033::[InvisiMole] lists local users and session information.",
        "T1036.004::[InvisiMole] has attempted to disguise itself by registering under a seemingly legitimate service name.",
        "T1036.005::[InvisiMole] has disguised its droppers as legitimate software or documents, matching their original names and locations, and saved its files as mpr.dll in the Windows folder.",
        "T1046::[InvisiMole] can scan the network for open ports and vulnerable instances of RDP and SMB protocols.",
        "T1053.005::[InvisiMole] has used scheduled tasks named MSST and \\Microsoft\\Windows\\Autochk\\Scheduled to establish persistence.",
        "T1055.002::[InvisiMole] can inject its backdoor as a portable executable into a target process.",
        "T1055.004::[InvisiMole] can inject its code into a trusted process via the APC queue.",
        "T1055.015::[InvisiMole] has used ListPlanting to inject code into a trusted process.",
        "T1055::[InvisiMole] can inject itself into another process to avoid detection including use of a technique called ListPlanting that customizes the sorting algorithm in a ListView structure.",
        "T1056.001::[InvisiMole] can capture keystrokes on a compromised host.",
        "T1057::[InvisiMole] can obtain a list of running processes.",
        "T1059.003::[InvisiMole] can launch a remote shell to execute commands.",
        "T1059.007::[InvisiMole] can use a JavaScript file as part of its execution chain.",
        "T1068::[InvisiMole] has exploited CVE-2007-5633 vulnerability in the speedfan.sys driver to obtain kernel mode privileges.",
        "T1070.004::[InvisiMole] has deleted files and directories including XML and files successfully uploaded to C2 servers.",
        "T1070.005::[InvisiMole] can disconnect previously connected remote drives.",
        "T1070.006::[InvisiMole] samples were timestomped by the authors by setting the PE timestamps to all zero values. [InvisiMole] also has a built-in command to modify file times.",
        "T1071.001::[InvisiMole] uses HTTP for C2 communications.",
        "T1071.004::[InvisiMole] has used a custom implementation of DNS tunneling to embed C2 communications in DNS requests and replies.",
        "T1074.001::[InvisiMole] determines a working directory where it stores all the gathered data about the compromised machine.",
        "T1080::[InvisiMole] can replace legitimate software or documents in the compromised network with their trojanized versions, in an attempt to propagate itself within the network.",
        "T1082::[InvisiMole] can gather information on the mapped drives, OS version, computer name, DEP policy, memory size, and system volume serial number.",
        "T1083::[InvisiMole] can list information about files in a directory and recently opened or used documents. [InvisiMole] can also search for specific files by supplied file mask.",
        "T1087.001::[InvisiMole] has a command to list account information on the victim’s machine.",
        "T1090.001::[InvisiMole] can function as a proxy to create a server that relays communication between the client and C&C server, or between two clients.",
        "T1090.002::[InvisiMole] InvisiMole can identify proxy servers used by the victim and use them for C2 communication.",
        "T1095::[InvisiMole] has used TCP to download additional modules.",
        "T1105::[InvisiMole] can upload files to the victim's machine for operations.",
        "T1106::[InvisiMole] can use winapiexec tool for indirect execution of  ShellExecuteW and CreateProcessA.",
        "T1112::[InvisiMole] has a command to create, set, copy, or delete a specified Registry key or value.",
        "T1113::[InvisiMole] can capture screenshots of not only the entire screen, but of each separate window open, in case they are overlapping.",
        "T1119::[InvisiMole] can sort and collect specific documents as well as generate a list of all files on a newly inserted drive and store them in an encrypted file.",
        "T1123::[InvisiMole] can record sound using input audio devices.",
        "T1124::[InvisiMole] gathers the local system time from the victim’s machine.",
        "T1125::[InvisiMole] can remotely activate the victim’s webcam to capture content.",
        "T1132.002::[InvisiMole] can use a modified base32 encoding to encode data within the subdomain of C2 requests.",
        "T1135::[InvisiMole] can gather network share information.",
        "T1140::[InvisiMole] can decrypt, unpack and load a DLL from its resources, or from blobs encrypted with Data Protection API, two-key triple DES, and variations of the XOR cipher.",
        "T1203::[InvisiMole] has installed legitimate but vulnerable Total Video Player software and wdigest.dll library drivers on compromised hosts to exploit stack overflow and input validation vulnerabilities for code execution.",
        "T1204.002::[InvisiMole] can deliver trojanized versions of software and documents, relying on user execution.",
        "T1210::[InvisiMole] can spread within a network via the BlueKeep (CVE-2019-0708) and EternalBlue (CVE-2017-0144) vulnerabilities in RDP and SMB respectively.",
        "T1218.002::[InvisiMole] can register itself for execution and persistence via the Control Panel.",
        "T1218.011::[InvisiMole] has used rundll32.exe for execution.",
        "T1480.001::[InvisiMole] can use Data Protection API to encrypt its components on the victim’s computer, to evade detection, and to make sure the payload can only be decrypted and loaded on one specific compromised computer.",
        "T1490::[InvisiMole] can can remove all system restore points.",
        "T1497.001::[InvisiMole] can check for artifacts of VirtualBox, Virtual PC and VMware environment, and terminate itself if they are detected.",
        "T1518.001::[InvisiMole] can check for the presence of network sniffers, AV, and BitDefender firewall.",
        "T1518::[InvisiMole] can collect information about installed software used by specific users, software executed on user login, and software executed by each system.",
        "T1543.003::[InvisiMole] can register a Windows service named CsPower as part of its execution chain, and a Windows service named clr_optimization_v2.0.51527_X86 to achieve persistence.",
        "T1547.001::[InvisiMole] can place a lnk file in the Startup Folder to achieve persistence.",
        "T1547.009::[InvisiMole] can use a .lnk shortcut for the Control Panel to establish persistence.",
        "T1548.002::[InvisiMole] can use fileless UAC bypass and create an elevated COM object to escalate privileges.",
        "T1559.001::[InvisiMole] can use the ITaskService, ITaskDefinition and ITaskSettings COM interfaces to schedule a task.",
        "T1560.001::[InvisiMole] uses WinRAR to compress data that is intended to be exfiltrated.",
        "T1560.002::[InvisiMole] can use zlib to compress and decompress data.",
        "T1560.003::[InvisiMole] uses a variation of the XOR cipher to encrypt files before exfiltration.",
        "T1562.004::[InvisiMole] has a command to disable routing and the Firewall on the victim’s machine.",
        "T1564.001::[InvisiMole] can create hidden system directories.",
        "T1564.003::[InvisiMole] has executed legitimate tools in hidden windows.",
        "T1569.002::[InvisiMole] has used Windows services as a way to execute its malicious payload.",
        "T1573.001::[InvisiMole] uses variations of a simple XOR encryption routine for C&C communications.",
        "T1574.001::[InvisiMole] can be launched by using DLL search order hijacking in which the wrapper DLL is placed in the same folder as explorer.exe and loaded during startup into the Windows Explorer process instead of the legitimate library."
      ]
    },
    "description": "[InvisiMole](https://attack.mitre.org/software/S0260) is a modular spyware program that has been used by the InvisiMole Group since at least 2013. [InvisiMole](https://attack.mitre.org/software/S0260) has two backdoor modules called RC2FM and RC2CL that are used to perform post-exploitation activities. It has been discovered on compromised victims in the Ukraine and Russia. [Gamaredon Group](https://attack.mitre.org/groups/G0047) infrastructure has been used to download and execute [InvisiMole](https://attack.mitre.org/software/S0260) against a small number of victims.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020)"
  }
]

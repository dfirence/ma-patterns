[
  {
    "id": "malware--3be1fb7a-0f7e-415e-8e3a-74a80d596e68",
    "name": "mafalda",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S1060",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "initial-access",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 35,
        "items": [
          "T1003.001",
          "T1005",
          "T1012",
          "T1016",
          "T1027",
          "T1033",
          "T1041",
          "T1049",
          "T1056",
          "T1057",
          "T1059.001",
          "T1059.003",
          "T1070.001",
          "T1071.001",
          "T1074.001",
          "T1082",
          "T1083",
          "T1090.001",
          "T1095",
          "T1105",
          "T1106",
          "T1112",
          "T1113",
          "T1132.001",
          "T1133",
          "T1134",
          "T1134.003",
          "T1140",
          "T1205.001",
          "T1217",
          "T1518.001",
          "T1552.004",
          "T1569.002",
          "T1573.001",
          "T1622"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "metador"
        ]
      },
      "procedures": [
        "T1003.001::[Mafalda] can dump password hashes from `LSASS.exe`.",
        "T1005::[Mafalda] can collect files and information from a compromised host.",
        "T1012::[Mafalda] can enumerate Registry keys with all subkeys and values.",
        "T1016::[Mafalda] can use the `GetAdaptersInfo` function to retrieve information about network adapters and the `GetIpNetTable` function to retrieve the IPv4 to physical network address mapping table.",
        "T1027::[Mafalda] has been obfuscated and contains encrypted functions.",
        "T1033::[Mafalda] can collect the username from a compromised host.",
        "T1041::[Mafalda] can send network system data and files to its C2 server.",
        "T1049::[Mafalda] can use the GetExtendedTcpTable function to retrieve information about established TCP connections.",
        "T1056::[Mafalda] can conduct mouse event logging.",
        "T1057::[Mafalda] can enumerate running processes on a machine.",
        "T1059.001::[Mafalda] can execute PowerShell commands on a compromised machine.",
        "T1059.003::[Mafalda] can execute shell commands using `cmd.exe`.",
        "T1070.001::[Mafalda] can delete Windows Event logs by invoking the `OpenEventLogW` and `ClearEventLogW` functions.",
        "T1071.001::[Mafalda] can use HTTP for C2.",
        "T1074.001::[Mafalda] can place retrieved files into a destination directory.",
        "T1082::[Mafalda] can collect the computer name and enumerate all drives on a compromised host.",
        "T1083::[Mafalda] can search for files and directories.",
        "T1090.001::[Mafalda] can create a named pipe to listen for and send data to a named pipe-based C2 server.",
        "T1095::[Mafalda] can use raw TCP for C2.",
        "T1105::[Mafalda] can download additional files onto the compromised host.",
        "T1106::[Mafalda] can use a variety of API calls.",
        "T1112::[Mafalda] can manipulate the system registry on a compromised host.",
        "T1113::[Mafalda] can take a screenshot of the target machine and save it to a file.",
        "T1132.001::[Mafalda] can encode data using Base64 prior to exfiltration.",
        "T1133::[Mafalda] can establish an SSH connection from a compromised host to a server.",
        "T1134.003::[Mafalda] can create a token for a different user.",
        "T1134::[Mafalda] can use `AdjustTokenPrivileges()` to elevate privileges.",
        "T1140::[Mafalda] can decrypt files and data.",
        "T1205.001::[Mafalda] can use port-knocking to authenticate itself to another implant called Cryshell to establish an indirect connection to the C2 server.",
        "T1217::[Mafalda] can collect the contents of the `%USERPROFILE%\\AppData\\Local\\Google\\Chrome\\User Data\\LocalState` file.",
        "T1518.001::[Mafalda] can search for a variety of security software programs, EDR systems, and malware analysis tools.",
        "T1552.004::[Mafalda] can collect a Chrome encryption key used to protect browser cookies.",
        "T1569.002::[Mafalda] can create a remote service, let it run once, and then delete it.",
        "T1573.001::[Mafalda] can encrypt its C2 traffic with RC4.",
        "T1622::[Mafalda] can search for debugging tools on a compromised host."
      ]
    },
    "description": "[Mafalda](https://attack.mitre.org/software/S1060) is a flexible interactive implant that has been used by [Metador](https://attack.mitre.org/groups/G1013). Security researchers assess the [Mafalda](https://attack.mitre.org/software/S1060) name may be inspired by an Argentinian cartoon character that has been popular as a means of political commentary since the 1960s. (Citation: SentinelLabs Metador Sept 2022)"
  }
]

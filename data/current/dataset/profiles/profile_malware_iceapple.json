[
  {
    "id": "malware--dd889a55-fb2c-4ec7-8e9f-c399939a49e1",
    "name": "iceapple",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S1022",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 7,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "exfiltration",
          "persistence"
        ]
      },
      "techniques": {
        "count": 19,
        "items": [
          "T1003.002",
          "T1003.004",
          "T1005",
          "T1016",
          "T1027.010",
          "T1036.005",
          "T1041",
          "T1056.003",
          "T1070.004",
          "T1071.001",
          "T1082",
          "T1083",
          "T1087.002",
          "T1140",
          "T1505.004",
          "T1552.002",
          "T1560.001",
          "T1573.001",
          "T1620"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1003.002::[IceApple]'s Credential Dumper module can dump encrypted password hashes from SAM registry keys, including `HKLM\\SAM\\SAM\\Domains\\Account\\F` and `HKLM\\SAM\\SAM\\Domains\\Account\\Users\\*\\V`.",
        "T1003.004::[IceApple]'s Credential Dumper module can dump LSA secrets from registry keys, including: `HKLM\\SECURITY\\Policy\\PolEKList\\default`, `HKLM\\SECURITY\\Policy\\Secrets\\*\\CurrVal`, and `HKLM\\SECURITY\\Policy\\Secrets\\*\\OldVal`.",
        "T1005::[IceApple] can collect files, passwords, and other data from a compromised host.",
        "T1016::The [IceApple] [ifconfig] module can iterate over all network interfaces on the host and retrieve the name, description, MAC address, DNS suffix, DNS servers, gateways, IPv4 addresses, and subnet masks.",
        "T1027.010::[IceApple] can use Base64 and \"junk\" JavaScript code to obfuscate information.",
        "T1036.005::[IceApple] .NET assemblies have used `App_Web_` in their file names to appear legitimate.",
        "T1041::[IceApple]'s Multi File Exfiltrator module can exfiltrate multiple files from a compromised host as an HTTP response over C2.",
        "T1056.003::The [IceApple] OWA credential logger can monitor for OWA authentication requests and log the credentials.",
        "T1070.004::[IceApple] can delete files and directories from targeted systems.",
        "T1071.001::[IceApple] can use HTTP GET to request and pull information from C2.",
        "T1082::The [IceApple] Server Variable Dumper module iterates over all server variables present for the current request and returns them to the adversary.",
        "T1083::The [IceApple] Directory Lister module can list information about files and directories including creation time, last write time, name, and size.",
        "T1087.002::The [IceApple] Active Directory Querier module  can perform authenticated requests against an Active Directory server.",
        "T1140::[IceApple] can use a Base64-encoded AES key to decrypt tasking.",
        "T1505.004::[IceApple] is an IIS post-exploitation framework, consisting of 18 modules that provide several functionalities.",
        "T1552.002::[IceApple] can harvest credentials from local and remote host registries.",
        "T1560.001::[IceApple] can encrypt and compress files using Gzip prior to exfiltration.",
        "T1573.001::The [IceApple] Result Retriever module can AES encrypt C2 responses.",
        "T1620::[IceApple] can use reflective code loading to load .NET assemblies into `MSExchangeOWAAppPool` on targeted Exchange servers."
      ]
    },
    "description": "[IceApple](https://attack.mitre.org/software/S1022) is a modular Internet Information Services (IIS) post-exploitation framework, that has been used since at least 2021 against the technology, academic, and government sectors.(Citation: CrowdStrike IceApple May 2022)"
  }
]

[
  {
    "id": "malware--4b6ec280-7bbb-48ff-ae59-b189520ebe83",
    "name": "okrum",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0439",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 33,
        "items": [
          "T1001.003",
          "T1003.001",
          "T1003.005",
          "T1016",
          "T1027.003",
          "T1033",
          "T1036.004",
          "T1041",
          "T1049",
          "T1053.005",
          "T1056.001",
          "T1059.003",
          "T1070.004",
          "T1071.001",
          "T1082",
          "T1083",
          "T1090.002",
          "T1105",
          "T1124",
          "T1132.001",
          "T1134.001",
          "T1140",
          "T1497.001",
          "T1497.002",
          "T1497.003",
          "T1543.003",
          "T1547.001",
          "T1547.009",
          "T1560.001",
          "T1560.003",
          "T1564.001",
          "T1569.002",
          "T1573.001"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "ke3chang"
        ]
      },
      "procedures": [
        "T1001.003::[Okrum] mimics HTTP protocol for C2 communication, while hiding the actual messages in the Cookie and Set-Cookie headers of the HTTP requests.",
        "T1003.001::[Okrum] was seen using MimikatzLite to perform credential dumping.",
        "T1003.005::[Okrum] was seen using modified Quarks PwDump to perform credential dumping.",
        "T1016::[Okrum] can collect network information, including the host IP address, DNS, and proxy information.",
        "T1027.003::[Okrum]'s payload is encrypted and embedded within its loader, or within a legitimate PNG file.",
        "T1033::[Okrum] can collect the victim username.",
        "T1036.004::[Okrum] can establish persistence by adding a new service NtmsSvc with the display name Removable Storage to masquerade as a legitimate Removable Storage Manager.",
        "T1041::Data exfiltration is done by [Okrum] using the already opened channel with the C2 server.",
        "T1049::[Okrum] was seen using NetSess to discover NetBIOS sessions.",
        "T1053.005::[Okrum]'s installer can attempt to achieve persistence by creating a scheduled task.",
        "T1056.001::[Okrum] was seen using a keylogger tool to capture keystrokes.",
        "T1059.003::[Okrum]'s backdoor has used cmd.exe to execute arbitrary commands as well as batch scripts to update itself to a newer version.",
        "T1070.004::[Okrum]'s backdoor deletes files after they have been successfully uploaded to C2 servers.",
        "T1071.001::[Okrum] uses HTTP for communication with its C2.",
        "T1082::[Okrum] can collect computer name, locale information, and information about the OS and architecture.",
        "T1083::[Okrum] has used DriveLetterView to enumerate drive information.",
        "T1090.002::[Okrum] can identify proxy servers configured and used by the victim, and use it to make HTTP requests to C2 its server.",
        "T1105::[Okrum] has built-in commands for uploading, downloading, and executing files to the system.",
        "T1124::[Okrum] can obtain the date and time of the compromised system.",
        "T1132.001::[Okrum] has used base64 to encode C2 communication.",
        "T1134.001::[Okrum] can impersonate a logged-on user's security context using a call to the ImpersonateLoggedOnUser API.",
        "T1140::[Okrum]'s loader can decrypt the backdoor code, embedded within the loader or within a legitimate PNG file. A custom XOR cipher or RC4 is used for decryption.",
        "T1497.001::[Okrum]'s loader can check the amount of physical memory and terminates itself if the host has less than 1.5 Gigabytes of physical memory in total.",
        "T1497.002::[Okrum] loader only executes the payload after the left mouse button has been pressed at least three times, in order to avoid being executed within virtualized or emulated environments.",
        "T1497.003::[Okrum]'s loader can detect presence of an emulator by using two calls to GetTickCount API, and checking whether the time has been accelerated.",
        "T1543.003::To establish persistence, [Okrum] can install itself as a new service named NtmSsvc.",
        "T1547.001::[Okrum] establishes persistence by creating a .lnk shortcut to itself in the Startup folder.",
        "T1547.009::[Okrum] can establish persistence by creating a .lnk shortcut to itself in the Startup folder.",
        "T1560.001::[Okrum] was seen using a RAR archiver tool to compress/decompress data.",
        "T1560.003::[Okrum] has used a custom implementation of AES encryption to encrypt collected data.",
        "T1564.001::Before exfiltration, [Okrum]'s backdoor has used hidden files to store logs and outputs from backdoor commands.",
        "T1569.002::[Okrum]'s loader can create a new service named NtmsSvc to execute the payload.",
        "T1573.001::[Okrum] uses AES to encrypt network traffic. The key can be hardcoded or negotiated with the C2 server in the registration phase."
      ]
    },
    "description": "[Okrum](https://attack.mitre.org/software/S0439) is a Windows backdoor that has been seen in use since December 2016 with strong links to [Ke3chang](https://attack.mitre.org/groups/G0004).(Citation: ESET Okrum July 2019)"
  }
]

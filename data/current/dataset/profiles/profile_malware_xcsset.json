[
  {
    "id": "malware--e14085cb-0e8d-4be6-92ba-e3b93ee5978f",
    "name": "xcsset",
    "aliases": "none",
    "platforms": "macos",
    "malware_id": "S0658",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 11,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "impact",
          "initial-access",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 29,
        "items": [
          "T1005",
          "T1036",
          "T1041",
          "T1056.002",
          "T1059.004",
          "T1068",
          "T1082",
          "T1083",
          "T1087",
          "T1098.004",
          "T1105",
          "T1113",
          "T1195.001",
          "T1222.002",
          "T1486",
          "T1497.003",
          "T1518",
          "T1518.001",
          "T1539",
          "T1543.004",
          "T1553.001",
          "T1554",
          "T1560",
          "T1564.001",
          "T1569.001",
          "T1573.001",
          "T1574.006",
          "T1614.001",
          "T1647"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1005::[XCSSET] collects contacts and application data from files in Desktop, Documents, Downloads, Dropbox, and WeChat folders.",
        "T1036::[XCSSET] builds a malicious application bundle to resemble Safari through using the Safari icon and Info.plist.",
        "T1041::[XCSSET] exfiltrates data stolen from a system over its C2 channel.",
        "T1056.002::[XCSSET] prompts the user to input credentials using a native macOS dialog box leveraging the system process /Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment.",
        "T1059.004::[XCSSET] uses a shell script to execute Mach-o files and osacompile commands such as, osacompile -x -o xcode.app main.applescript.",
        "T1068::[XCSSET] has used a zero-day exploit in the ssh launchdaemon to elevate privileges and bypass SIP.",
        "T1082::[XCSSET] identifies the macOS version and uses ioreg to determine serial number.",
        "T1083::[XCSSET] has used `mdfind` to enumerate a list of apps known to grant screen sharing permissions.",
        "T1087::[XCSSET] attempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data.",
        "T1098.004::[XCSSET] will create an ssh key if necessary with the ssh-keygen -t rsa -f $HOME/.ssh/id_rsa -P command. [XCSSET] will upload a private key file to the server to remotely access the host without a password.",
        "T1105::[XCSSET] downloads browser specific AppleScript modules using a constructed URL with the curl command, https://\" & domain & \"/agent/scripts/\" & moduleName & \".applescript.",
        "T1113::[XCSSET] saves a screen capture of the victim's system with a numbered filename and .jpg extension. Screen captures are taken at specified intervals based on the system.",
        "T1195.001::[XCSSET] adds malicious code to a host's Xcode projects by enumerating CocoaPods target_integrator.rb files under the /Library/Ruby/Gems folder or enumerates all .xcodeproj folders under a given directory. [XCSSET] then downloads a script and Mach-O file into the Xcode project folder.",
        "T1222.002::[XCSSET] uses the chmod +x command to grant executable permissions to the malicious file.",
        "T1486::[XCSSET] performs AES-CBC encryption on files under ~/Documents, ~/Downloads, and\n~/Desktop with a fixed key and renames files to give them a .enc extension. Only files with sizes \nless than 500MB are encrypted.",
        "T1497.003::Using the machine's local time, [XCSSET] waits 43200 seconds (12 hours) from the initial creation timestamp of a specific file, .report. After the elapsed time, [XCSSET] executes additional modules.",
        "T1518.001::[XCSSET] searches firewall configuration files located in /Library/Preferences/ and uses csrutil status to determine if System Integrity Protection is enabled.",
        "T1518::[XCSSET] uses ps aux with the grep command to enumerate common browsers and system processes potentially impacting [XCSSET]'s exfiltration capabilities.",
        "T1539::[XCSSET] uses scp to access the ~/Library/Cookies/Cookies.binarycookies file.",
        "T1543.004::[XCSSET] uses the ssh launchdaemon to elevate privileges, bypass system controls, and enable remote access to the victim.",
        "T1553.001::[XCSSET] has dropped a malicious applet into an app's `.../Contents/MacOS/` folder of a previously launched app to bypass Gatekeeper's security checks on first launch apps (prior to macOS 13).",
        "T1554::[XCSSET] uses a malicious browser application to replace the legitimate browser in order to continuously capture credentials, monitor web traffic, and download additional modules.",
        "T1560::[XCSSET] will compress entire ~/Desktop folders excluding all .git folders, but only if the total data size is under 200MB.",
        "T1564.001::[XCSSET] uses a hidden folder named .xcassets and .git to embed itself in Xcode.",
        "T1569.001::[XCSSET] loads a system level launchdaemon using the launchctl load -w command from /System/Librarby/LaunchDaemons/ssh.plist.",
        "T1573.001::[XCSSET] uses RC4 encryption over TCP to communicate with its C2 server.",
        "T1574.006::[XCSSET] adds malicious file paths to the DYLD_FRAMEWORK_PATH and DYLD_LIBRARY_PATH environment variables to execute malicious code.",
        "T1614.001::[XCSSET] uses AppleScript to check the host's language and location with the command user locale of (get system info).",
        "T1647::[XCSSET] uses the plutil command to modify the LSUIElement, DFBundleDisplayName, and CFBundleIdentifier keys in the /Contents/Info.plist file to change how [XCSSET] is visible on the system."
      ]
    },
    "description": "[XCSSET](https://attack.mitre.org/software/S0658) is a macOS modular backdoor that targets Xcode application developers. [XCSSET](https://attack.mitre.org/software/S0658) was first observed in August 2020 and has been used to install a backdoor component, modify browser applications, conduct collection, and provide ransomware-like encryption capabilities.(Citation: trendmicro xcsset xcode project 2020)"
  }
]

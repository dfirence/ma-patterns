[
  {
    "id": "malware--f1314e75-ada8-49f4-b281-b1fb8b48f2a7",
    "name": "osxshlayer",
    "aliases": "none",
    "platforms": "macos",
    "malware_id": "S0402",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 14,
        "items": [
          "T1036.005",
          "T1059.004",
          "T1082",
          "T1083",
          "T1105",
          "T1140",
          "T1176",
          "T1204.002",
          "T1222.002",
          "T1548.004",
          "T1553.001",
          "T1564",
          "T1564.001",
          "T1564.009"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1036.005::[OSX/Shlayer] can masquerade as a Flash Player update.",
        "T1059.004::[OSX/Shlayer] can use bash scripts to check the macOS version, download payloads, and extract bytes from files. [OSX/Shlayer] uses the command sh -c tail -c +1381... to extract bytes at an offset from a specified file. [OSX/Shlayer] uses the curl -fsL \"$url\" >$tmp_path command to download malicious payloads into a temporary directory.",
        "T1082::[OSX/Shlayer] has collected the IOPlatformUUID, session UID, and the OS version using the command sw_vers -productVersion.",
        "T1083::[OSX/Shlayer] has used the command appDir=\"$(dirname $(dirname \"$currentDir\"))\" and $(dirname \"$(pwd -P)\") to construct installation paths.",
        "T1105::[OSX/Shlayer] can download payloads, and extract bytes from files. [OSX/Shlayer] uses the curl -fsL \"$url\" >$tmp_path command to download malicious payloads into a temporary directory.",
        "T1140::[OSX/Shlayer] can base64-decode and AES-decrypt downloaded payloads.",
        "T1176::[OSX/Shlayer] can install malicious Safari browser extensions to serve ads.",
        "T1204.002::[OSX/Shlayer] has relied on users mounting and executing a malicious DMG file.",
        "T1222.002::[OSX/Shlayer] can use the chmod utility to set a file as executable, such as chmod 777 or chmod +x.",
        "T1548.004::[OSX/Shlayer] can escalate privileges to root by asking the user for credentials.",
        "T1553.001::If running with elevated privileges, [OSX/Shlayer] has used the spctl command to disable Gatekeeper protection for a downloaded file. [OSX/Shlayer] can also leverage system links pointing to bash scripts in the downloaded DMG file to bypass Gatekeeper, a flaw patched in macOS 11.3 and later versions. [OSX/Shlayer] has been Notarized by Apple, resulting in successful passing of additional Gatekeeper checks.",
        "T1564.001::[OSX/Shlayer] has executed a .command script from a hidden directory in a mounted DMG.",
        "T1564.009::[OSX/Shlayer] has used a resource fork to hide a compressed binary file of itself from the terminal, Finder, and potentially evade traditional scanners.",
        "T1564::[OSX/Shlayer] has used the mktemp utility to make random and unique filenames for payloads, such as export tmpDir=\"$(mktemp -d /tmp/XXXXXXXXXXXX)\" or mktemp -t Installer."
      ]
    },
    "description": "[OSX/Shlayer](https://attack.mitre.org/software/S0402) is a Trojan designed to install adware on macOS that was first discovered in 2018.(Citation: Carbon Black Shlayer Feb 2019)(Citation: Intego Shlayer Feb 2018)"
  }
]

[
  {
    "id": "malware--c2417bab-3189-4d4d-9d60-96de2cdaf0ab",
    "name": "kwampirs",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0236",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "lateral-movement",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 22,
        "items": [
          "T1007",
          "T1008",
          "T1016",
          "T1018",
          "T1021.002",
          "T1027",
          "T1027.001",
          "T1033",
          "T1036.004",
          "T1049",
          "T1057",
          "T1069.001",
          "T1069.002",
          "T1082",
          "T1083",
          "T1087.001",
          "T1105",
          "T1135",
          "T1140",
          "T1201",
          "T1218.011",
          "T1543.003"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "orangeworm"
        ]
      },
      "procedures": [
        "T1007::[Kwampirs] collects a list of running services with the command tasklist /svc.",
        "T1008::[Kwampirs] uses a large list of C2 servers that it cycles through until a successful connection is established.",
        "T1016::[Kwampirs] collects network adapter and interface information by using the commands ipconfig /all, arp -a and route print. It also collects the system's MAC address with getmac and domain configuration with net config workstation.",
        "T1018::[Kwampirs] collects a list of available servers with the command net view.",
        "T1021.002::[Kwampirs] copies itself over network shares to move laterally on a victim network.",
        "T1027.001::Before writing to disk, [Kwampirs] inserts a randomly generated string into the middle of the decrypted payload in an attempt to evade hash-based detections.",
        "T1027::[Kwampirs] downloads additional files that are base64-encoded and encrypted with another cipher.",
        "T1033::[Kwampirs] collects registered owner details by using the commands systeminfo and net config workstation.",
        "T1036.004::[Kwampirs] establishes persistence by adding a new service with the display name \"WMI Performance Adapter Extension\" in an attempt to masquerade as a legitimate WMI service.",
        "T1049::[Kwampirs] collects a list of active and listening connections by using the command netstat -nao as well as a list of available network mappings with net use.",
        "T1057::[Kwampirs] collects a list of running services with the command tasklist /v.",
        "T1069.001::[Kwampirs] collects a list of users belonging to the local users and administrators groups with the commands net localgroup administrators and net localgroup users.",
        "T1069.002::[Kwampirs] collects a list of domain groups with the command net localgroup /domain.",
        "T1082::[Kwampirs] collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands systeminfo, net config workstation, hostname, ver, set, and date /t.",
        "T1083::[Kwampirs] collects a list of files and directories in C:\\ with the command dir /s /a c:\\ >> \"C:\\windows\\TEMP\\[RANDOM].tmp\".",
        "T1087.001::[Kwampirs] collects a list of accounts with the command net users.",
        "T1105::[Kwampirs] downloads additional files from C2 servers.",
        "T1135::[Kwampirs] collects a list of network shares with the command net share.",
        "T1140::[Kwampirs] decrypts and extracts a copy of its main DLL payload when executing.",
        "T1201::[Kwampirs] collects password policy information with the command net accounts.",
        "T1218.011::[Kwampirs] uses rundll32.exe in a Registry value added to establish persistence.",
        "T1543.003::[Kwampirs] creates a new service named WmiApSrvEx to establish persistence."
      ]
    },
    "description": "[Kwampirs](https://attack.mitre.org/software/S0236) is a backdoor Trojan used by [Orangeworm](https://attack.mitre.org/groups/G0071). It has been found on machines which had software installed for the use and control of high-tech imaging devices such as X-Ray and MRI machines. (Citation: Symantec Orangeworm April 2018)"
  }
]

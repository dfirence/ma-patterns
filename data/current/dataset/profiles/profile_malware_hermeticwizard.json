[
  {
    "id": "malware--ff7ed9c1-dca3-4e62-9da6-72c5d388b8fa",
    "name": "hermeticwizard",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0698",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 5,
        "items": [
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "lateral-movement"
        ]
      },
      "techniques": {
        "count": 16,
        "items": [
          "T1018",
          "T1021.002",
          "T1027",
          "T1036.005",
          "T1046",
          "T1047",
          "T1059.003",
          "T1070.001",
          "T1106",
          "T1110.001",
          "T1218.010",
          "T1218.011",
          "T1553.002",
          "T1559.001",
          "T1569.002",
          "T1570"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1018::[HermeticWizard] can find machines on the local network by gathering known local IP addresses through `DNSGetCacheDataTable`, `GetIpNetTable`,`WNetOpenEnumW(RESOURCE_GLOBALNET, RESOURCETYPE_ANY)`,`NetServerEnum`,`GetTcpTable`, and `GetAdaptersAddresses.`",
        "T1021.002::[HermeticWizard] can use a list of hardcoded credentials to to authenticate via NTLMSSP to the SMB shares on remote systems.",
        "T1027::[HermeticWizard] has the ability to encrypt PE files with a reverse XOR loop.",
        "T1036.005::[HermeticWizard] has been named `exec_32.dll` to mimic a legitimate MS Outlook .dll.",
        "T1046::[HermeticWizard] has the ability to scan ports on a compromised network.",
        "T1047::[HermeticWizard] can use WMI to create a new process on a remote machine via `C:\\windows\\system32\\cmd.exe /c start C:\\windows\\system32\\\\regsvr32.exe /s /iC:\\windows\\<filename>.dll`.",
        "T1059.003::[HermeticWizard] can use `cmd.exe` for execution on compromised hosts.",
        "T1070.001::[HermeticWizard] has the ability to use `wevtutil cl system` to clear event logs.",
        "T1106::[HermeticWizard] can connect to remote shares using `WNetAddConnection2W`.",
        "T1110.001::[HermeticWizard] can use a list of hardcoded credentials in attempt to authenticate to SMB shares.",
        "T1218.010::[HermeticWizard] has used `regsvr32.exe /s /i` to execute malicious payloads.",
        "T1218.011::[HermeticWizard] has the ability to create a new process using `rundll32`.",
        "T1553.002::[HermeticWizard] has been signed by valid certificates assigned to Hermetica Digital.",
        "T1559.001::[HermeticWizard] can execute files on remote machines using DCOM.",
        "T1569.002::[HermeticWizard] can use `OpenRemoteServiceManager` to create a service.",
        "T1570::[HermeticWizard] can copy files to other machines on a compromised network."
      ]
    },
    "description": "[HermeticWizard](https://attack.mitre.org/software/S0698) is a worm that has been used to spread [HermeticWiper](https://attack.mitre.org/software/S0697) in attacks against organizations in Ukraine since at least 2022.(Citation: ESET Hermetic Wizard March 2022)"
  }
]

[
  {
    "id": "malware--5763217a-05b6-4edd-9bca-057e47b5e403",
    "name": "shimrat",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0444",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 8,
        "items": [
          "collection",
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 21,
        "items": [
          "T1005",
          "T1008",
          "T1027",
          "T1027.002",
          "T1029",
          "T1036.004",
          "T1059.003",
          "T1070.004",
          "T1071.001",
          "T1083",
          "T1090.002",
          "T1105",
          "T1106",
          "T1112",
          "T1135",
          "T1140",
          "T1543.003",
          "T1546.011",
          "T1547.001",
          "T1548.002",
          "T1574"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "mofang"
        ]
      },
      "procedures": [
        "T1005::[ShimRat] has the capability to upload collected files to a C2.",
        "T1008::[ShimRat] has used a secondary C2 location if the first was unavailable.",
        "T1027.002::[ShimRat]'s loader has been packed with the compressed [ShimRat] core DLL and the legitimate DLL for it to hijack.",
        "T1027::[ShimRat] has been delivered as a package that includes compressed DLL and shellcode payloads within a .dat file.",
        "T1029::[ShimRat] can sleep when instructed to do so by the C2.",
        "T1036.004::[ShimRat] can impersonate Windows services and antivirus products to avoid detection on compromised systems.",
        "T1059.003::[ShimRat] can be issued a command shell function from the C2.",
        "T1070.004::[ShimRat] can uninstall itself from compromised hosts, as well create and modify directories, delete, move, copy, and rename files.",
        "T1071.001::[ShimRat] communicated over HTTP and HTTPS with C2 servers.",
        "T1083::[ShimRat] can list directories.",
        "T1090.002::[ShimRat] can use pre-configured HTTP proxies.",
        "T1105::[ShimRat] can download additional files.",
        "T1106::[ShimRat] has used Windows API functions to install the service and shim.",
        "T1112::[ShimRat] has registered two registry keys for shim databases.",
        "T1135::[ShimRat] can enumerate connected drives for infected host machines.",
        "T1140::[ShimRat] has decompressed its core DLL using shellcode once an impersonated antivirus component was running on a system.",
        "T1543.003::[ShimRat] has installed a Windows service to maintain persistence on victim machines.",
        "T1546.011::[ShimRat] has installed shim databases in the AppPatch folder.",
        "T1547.001::[ShimRat] has installed a registry based start-up key HKCU\\Software\\microsoft\\windows\\CurrentVersion\\Run to maintain persistence should other methods fail.",
        "T1548.002::[ShimRat] has hijacked the cryptbase.dll within migwiz.exe to escalate privileges. This prevented the User Access Control window from appearing.",
        "T1574::[ShimRat] can hijack the cryptbase.dll within migwiz.exe to escalate privileges and bypass UAC controls."
      ]
    },
    "description": "[ShimRat](https://attack.mitre.org/software/S0444) has been used by the suspected China-based adversary [Mofang](https://attack.mitre.org/groups/G0103) in campaigns targeting multiple countries and sectors including government, military, critical infrastructure, automobile, and weapons development. The name \"[ShimRat](https://attack.mitre.org/software/S0444)\" comes from the malware's extensive use of Windows Application Shimming to maintain persistence. (Citation: FOX-IT May 2016 Mofang)"
  }
]

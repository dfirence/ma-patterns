[
  {
    "id": "malware--8901ac23-6b50-410c-b0dd-d8174a86f9b3",
    "name": "shamoon",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0140",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "impact",
          "initial-access",
          "lateral-movement",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 24,
        "items": [
          "T1012",
          "T1016",
          "T1018",
          "T1021.002",
          "T1027",
          "T1036.004",
          "T1053.005",
          "T1070.006",
          "T1071.001",
          "T1078.002",
          "T1082",
          "T1105",
          "T1112",
          "T1124",
          "T1134.001",
          "T1140",
          "T1485",
          "T1486",
          "T1529",
          "T1543.003",
          "T1548.002",
          "T1561.002",
          "T1569.002",
          "T1570"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1012::[Shamoon] queries several Registry keys to identify hard disk partitions to overwrite.",
        "T1016::[Shamoon] obtains the target's IP address and local network segment.",
        "T1018::[Shamoon] scans the C-class subnet of the IPs on the victim's interfaces.",
        "T1021.002::[Shamoon] accesses network share(s), enables share access to the target device, copies an executable payload to the target system, and uses a [Scheduled Task/Job] to execute the malware.",
        "T1027::[Shamoon] contains base64-encoded strings.",
        "T1036.004::[Shamoon] creates a new service named “ntssrv” that attempts to appear legitimate; the service's display name is “Microsoft Network Realtime Inspection Service” and its description is “Helps guard against time change attempts targeting known and newly discovered vulnerabilities in network time protocols.” Newer versions create the \"MaintenaceSrv\" service, which misspells the word \"maintenance.\"",
        "T1053.005::[Shamoon] copies an executable payload to the target system by using [SMB/Windows Admin Shares] and then scheduling an unnamed task to execute the malware.",
        "T1070.006::[Shamoon] can change the modified time for files to evade forensic detection.",
        "T1071.001::[Shamoon] has used HTTP for C2.",
        "T1078.002::If [Shamoon] cannot access shares using current privileges, it attempts access using hard coded, domain-specific credentials gathered earlier in the intrusion.",
        "T1082::[Shamoon] obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.",
        "T1105::[Shamoon] can download an executable to run on the victim.",
        "T1112::Once [Shamoon] has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.",
        "T1124::[Shamoon] obtains the system time and will only activate if it is greater than a preset date.",
        "T1134.001::[Shamoon] can impersonate tokens using LogonUser, ImpersonateLoggedOnUser, and ImpersonateNamedPipeClient.",
        "T1140::[Shamoon] decrypts ciphertext using an XOR cipher and a base64-encoded string.",
        "T1485::[Shamoon] attempts to overwrite operating system files and disk structures with image files.",
        "T1486::[Shamoon] has an operational mode for encrypting data instead of overwriting it.",
        "T1529::[Shamoon] will reboot the infected system once the wiping functionality has been completed.",
        "T1543.003::[Shamoon] creates a new service named “ntssrv” to execute the payload. Newer versions create the \"MaintenaceSrv\" and \"hdv_725x\" services.",
        "T1548.002::[Shamoon] attempts to disable UAC remote restrictions by modifying the Registry.",
        "T1561.002::[Shamoon] has been seen overwriting features of disk structure such as the MBR.",
        "T1569.002::[Shamoon] creates a new service named “ntssrv” to execute the payload. [Shamoon] can also spread via [PsExec].",
        "T1570::[Shamoon] attempts to copy itself to remote machines on the network."
      ]
    },
    "description": "[Shamoon](https://attack.mitre.org/software/S0140) is wiper malware that was first used by an Iranian group known as the \"Cutting Sword of Justice\" in 2012. Other versions known as Shamoon 2 and Shamoon 3 were observed in 2016 and 2018. [Shamoon](https://attack.mitre.org/software/S0140) has also been seen leveraging [RawDisk](https://attack.mitre.org/software/S0364) and Filerase to carry out data wiping tasks. The term Shamoon is sometimes used to refer to the group using the malware as well as the malware itself.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018)(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)"
  }
]

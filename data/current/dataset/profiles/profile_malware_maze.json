[
  {
    "id": "malware--d9f7383c-95ec-4080-bbce-121c9384457b",
    "name": "maze",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0449",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 7,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "impact",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 23,
        "items": [
          "T1027",
          "T1027.001",
          "T1036.004",
          "T1047",
          "T1049",
          "T1053.005",
          "T1055.001",
          "T1057",
          "T1059.003",
          "T1070",
          "T1071.001",
          "T1082",
          "T1106",
          "T1218.007",
          "T1486",
          "T1489",
          "T1490",
          "T1529",
          "T1547.001",
          "T1562.001",
          "T1564.006",
          "T1568",
          "T1614.001"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "fin6"
        ]
      },
      "procedures": [
        "T1027.001::[Maze] has inserted large blocks of junk code, including some components to decrypt strings and other important information for later in the encryption process.",
        "T1027::[Maze] has decrypted strings and other important information during the encryption process. [Maze] also calls certain functions dynamically to hinder analysis.",
        "T1036.004::[Maze] operators have created scheduled tasks masquerading as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\" designed to launch the ransomware.",
        "T1047::[Maze] has used WMI to attempt to delete the shadow volumes on a machine, and to connect a virtual machine to the network domain of the victim organization's network.",
        "T1049::[Maze] has used the \"WNetOpenEnumW\", \"WNetEnumResourceW”, “WNetCloseEnum” and “WNetAddConnection2W” functions to enumerate the network resources on the infected machine.",
        "T1053.005::[Maze] has created scheduled tasks using name variants such as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\", to launch [Maze] at a specific time.",
        "T1055.001::[Maze] has injected the malware DLL into a target process.",
        "T1057::[Maze] has gathered all of the running system processes.",
        "T1059.003::The [Maze] encryption process has used batch scripts with various commands.",
        "T1070::[Maze] has used the “Wow64RevertWow64FsRedirection” function following attempts to delete the shadow volumes, in order to leave the system in the same state as it was prior to redirection.",
        "T1071.001::[Maze] has communicated to hard-coded IP addresses via HTTP.",
        "T1082::[Maze] has checked the language of the infected system using the \"GetUSerDefaultUILanguage\" function.",
        "T1106::[Maze] has used several Windows API functions throughout the encryption process including IsDebuggerPresent, TerminateProcess, Process32FirstW, among others.",
        "T1218.007::[Maze] has delivered components for its ransomware attacks using MSI files, some of which have been executed from the command-line using msiexec.",
        "T1486::[Maze] has disrupted systems by encrypting files on targeted machines, claiming to decrypt files if a ransom payment is made. [Maze] has used the ChaCha algorithm, based on Salsa20, and an RSA algorithm to encrypt files.",
        "T1489::[Maze] has stopped SQL services to ensure it can encrypt any database.",
        "T1490::[Maze] has attempted to delete the shadow volumes of infected machines, once before and once after the encryption process.",
        "T1529::[Maze] has issued a shutdown command on a victim machine that, upon reboot, will run the ransomware within a VM.",
        "T1547.001::[Maze] has created a file named \"startup_vrun.bat\" in the Startup folder of a virtual machine to establish persistence.",
        "T1562.001::[Maze] has disabled dynamic analysis and other security tools including IDA debugger, x32dbg, and OllyDbg.",
        "T1564.006::[Maze] operators have used VirtualBox and a Windows 7 virtual machine to run the ransomware; the virtual machine's configuration file mapped the shared network drives of the target company, presumably so [Maze] can encrypt files on the shared drives as well as the local machine.",
        "T1568::[Maze] has forged POST strings with a random choice from a list of possibilities including \"forum\", \"php\", \"view\", etc. while making connection with the C2, hindering detection efforts.",
        "T1614.001::[Maze] has checked the language of the machine with function GetUserDefaultUILanguage and terminated execution if the language matches with an entry in the predefined list."
      ]
    },
    "description": "[Maze](https://attack.mitre.org/software/S0449) ransomware, previously known as \"ChaCha\", was discovered in May 2019. In addition to encrypting files on victim machines for impact, [Maze](https://attack.mitre.org/software/S0449) operators conduct information stealing campaigns prior to encryption and post the information online to extort affected companies.(Citation: FireEye Maze May 2020)(Citation: McAfee Maze March 2020)(Citation: Sophos Maze VM September 2020)"
  }
]

[
  {
    "id": "malware--e355fc84-6f3c-4888-8e0a-d7fa9c378532",
    "name": "starwhale",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S1037",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 8,
        "items": [
          "collection",
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 14,
        "items": [
          "T1005",
          "T1016",
          "T1027",
          "T1033",
          "T1041",
          "T1059.003",
          "T1059.005",
          "T1071.001",
          "T1074.001",
          "T1082",
          "T1132.001",
          "T1204.002",
          "T1543.003",
          "T1547.001"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "muddywater"
        ]
      },
      "procedures": [
        "T1005::[STARWHALE] can collect data from an infected local host.",
        "T1016::[STARWHALE] has the ability to collect the IP address of an infected host.",
        "T1027::[STARWHALE] has been obfuscated with hex-encoded strings.",
        "T1033::[STARWHALE] can gather the username from an infected host.",
        "T1041::[STARWHALE] can exfiltrate collected data to its C2 servers.",
        "T1059.003::[STARWHALE] has the ability to execute commands via `cmd.exe`.",
        "T1059.005::[STARWHALE] can use the VBScript function `GetRef` as part of its persistence mechanism.",
        "T1071.001::[STARWHALE] has the ability to contact actor-controlled C2 servers via HTTP.",
        "T1074.001::[STARWHALE] has stored collected data in a file called `stari.txt`.",
        "T1082::[STARWHALE] can gather the computer name of an infected host.",
        "T1132.001::[STARWHALE] has the ability to hex-encode collected data from an infected host.",
        "T1204.002::[STARWHALE] has relied on victims opening a malicious Excel file for execution.",
        "T1543.003::[STARWHALE] has the ability to create the following Windows service to establish persistence on an infected host: `sc create Windowscarpstss binpath= \"cmd.exe /c cscript.exe c:\\\\windows\\\\system32\\\\w7_1.wsf humpback_whale\" start= \"auto\" obj= \"LocalSystem\"`.",
        "T1547.001::[STARWHALE] can establish persistence by installing itself in the startup folder, whereas the GO variant has created a `HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookM` registry key."
      ]
    },
    "description": "[STARWHALE](https://attack.mitre.org/software/S1037) is Windows Script File (WSF) backdoor that has been used by [MuddyWater](https://attack.mitre.org/groups/G0069), possibly since at least November 2021; there is also a [STARWHALE](https://attack.mitre.org/software/S1037) variant written in Golang with similar capabilities. Security researchers have also noted the use of [STARWHALE](https://attack.mitre.org/software/S1037) by UNC3313, which may be associated with [MuddyWater](https://attack.mitre.org/groups/G0069).(Citation: Mandiant UNC3313 Feb 2022)(Citation: DHS CISA AA22-055A MuddyWater February 2022)"
  }
]

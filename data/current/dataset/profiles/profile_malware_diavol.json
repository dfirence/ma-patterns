[
  {
    "id": "malware--4e9bdf9a-4957-47f6-87b3-c76898d3f623",
    "name": "diavol",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0659",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "impact",
          "lateral-movement"
        ]
      },
      "techniques": {
        "count": 19,
        "items": [
          "T1016",
          "T1018",
          "T1021.002",
          "T1027",
          "T1027.003",
          "T1033",
          "T1057",
          "T1071.001",
          "T1082",
          "T1083",
          "T1105",
          "T1106",
          "T1135",
          "T1485",
          "T1486",
          "T1489",
          "T1490",
          "T1491.001",
          "T1562.001"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1016::[Diavol] can enumerate victims' local and external IPs when registering with C2.",
        "T1018::[Diavol] can use the ARP table to find remote hosts to scan.",
        "T1021.002::[Diavol] can spread throughout a network via SMB prior to encryption.",
        "T1027.003::[Diavol] has obfuscated its main code routines within bitmap images as part of its anti-analysis techniques.",
        "T1027::[Diavol] has Base64 encoded the RSA public key used for encrypting files.",
        "T1033::[Diavol] can collect the username from a compromised host.",
        "T1057::[Diavol] has used `CreateToolhelp32Snapshot`, `Process32First`, and `Process32Next` API calls to enumerate the running processes in the system.",
        "T1071.001::[Diavol] has used HTTP GET and POST requests for C2.",
        "T1082::[Diavol] can collect the computer name and OS version from the system.",
        "T1083::[Diavol] has a command to traverse the files and directories in a given path.",
        "T1105::[Diavol] can receive configuration updates and additional payloads including wscpy.exe from C2.",
        "T1106::[Diavol] has used several API calls like `GetLogicalDriveStrings`, `SleepEx`, `SystemParametersInfoAPI`, `CryptEncrypt`, and others to execute parts of its attack.",
        "T1135::[Diavol] has a `ENMDSKS` command to enumerates available network shares.",
        "T1485::[Diavol] can delete specified files from a targeted system.",
        "T1486::[Diavol] has encrypted files using an RSA key though the `CryptEncrypt` API and has appended filenames with \".lock64\".",
        "T1489::[Diavol] will terminate services using the Service Control Manager (SCM) API.",
        "T1490::[Diavol] can delete shadow copies using the `IVssBackupComponents` COM object to call the `DeleteSnapshots` method.",
        "T1491.001::After encryption, [Diavol] will capture the desktop background window, set the background color to black, and change the desktop wallpaper to a newly created bitmap image with the text “All your files are encrypted! For more information see “README-FOR-DECRYPT.txt\".",
        "T1562.001::[Diavol] can attempt to stop security software."
      ]
    },
    "description": "[Diavol](https://attack.mitre.org/software/S0659) is a ransomware variant first observed in June 2021 that is capable of prioritizing file types to encrypt based on a pre-configured list of extensions defined by the attacker. [Diavol](https://attack.mitre.org/software/S0659) has been deployed by [Bazar](https://attack.mitre.org/software/S0534) and is thought to have potential ties to [Wizard Spider](https://attack.mitre.org/groups/G0102).(Citation: Fortinet Diavol July 2021)(Citation: FBI Flash Diavol January 2022)(Citation: DFIR Diavol Ransomware December 2021)"
  }
]

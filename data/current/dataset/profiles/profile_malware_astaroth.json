[
  {
    "id": "malware--edb24a93-1f7a-4bbf-a738-1397a14662c6",
    "name": "astaroth",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0373",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation",
          "reconnaissance"
        ]
      },
      "techniques": {
        "count": 36,
        "items": [
          "T1016",
          "T1027",
          "T1027.002",
          "T1027.010",
          "T1041",
          "T1047",
          "T1055.012",
          "T1056.001",
          "T1057",
          "T1059.003",
          "T1059.005",
          "T1059.007",
          "T1074.001",
          "T1082",
          "T1102.001",
          "T1105",
          "T1115",
          "T1124",
          "T1129",
          "T1132.001",
          "T1140",
          "T1204.002",
          "T1218.001",
          "T1218.010",
          "T1220",
          "T1497.001",
          "T1518.001",
          "T1547.001",
          "T1547.009",
          "T1552",
          "T1555",
          "T1564.003",
          "T1564.004",
          "T1568.002",
          "T1574.001",
          "T1598.002"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1016::[Astaroth] collects the external IP address from the system.",
        "T1027.002::[Astaroth] uses a software packer called Pe123\\RPolyCryptor.",
        "T1027.010::[Astaroth] has obfuscated and randomized parts of the JScript code it is initiating.",
        "T1027::[Astaroth] has used an XOR-based algorithm to encrypt payloads twice with different keys.",
        "T1041::[Astaroth] exfiltrates collected information from its r1.log file to the external C2 server.",
        "T1047::[Astaroth] uses WMIC to execute payloads.",
        "T1055.012::[Astaroth] can create a new process in a suspended state from a targeted legitimate process in order to unmap its memory and replace it with malicious code.",
        "T1056.001::[Astaroth] logs keystrokes from the victim's machine.",
        "T1057::[Astaroth] searches for different processes on the system.",
        "T1059.003::[Astaroth] spawns a CMD process to execute commands.",
        "T1059.005::[Astaroth] has used malicious VBS e-mail attachments for execution.",
        "T1059.007::[Astaroth] uses JavaScript to perform its core functionalities.",
        "T1074.001::[Astaroth] collects data in a plaintext file named r1.log before exfiltration.",
        "T1082::[Astaroth] collects the machine name and keyboard language from the system.",
        "T1102.001::[Astaroth] can store C2 information on cloud hosting services such as AWS and CloudFlare and websites like YouTube and Facebook.",
        "T1105::[Astaroth] uses [certutil] and [BITSAdmin] to download additional malware.",
        "T1115::[Astaroth] collects information from the clipboard by using the OpenClipboard() and GetClipboardData() libraries.",
        "T1124::[Astaroth] collects the timestamp from the infected machine.",
        "T1129::[Astaroth] uses the LoadLibraryExW() function to load additional modules.",
        "T1132.001::[Astaroth] encodes data using Base64 before sending it to the C2 server.",
        "T1140::[Astaroth] uses a fromCharCode() deobfuscation method to avoid explicitly writing execution commands and to hide its code.",
        "T1204.002::[Astaroth] has used malicious files including VBS, LNK, and HTML for execution.",
        "T1218.001::[Astaroth] uses ActiveX objects for file execution and manipulation.",
        "T1218.010::[Astaroth] can be loaded through regsvr32.exe.",
        "T1220::[Astaroth] executes embedded JScript or VBScript in an XSL stylesheet located on a remote domain.",
        "T1497.001::[Astaroth] can check for Windows product ID's used by sandboxes and usernames and disk serial numbers associated with analyst environments.",
        "T1518.001::[Astaroth] checks for the presence of Avast antivirus in the C:\\Program\\Files\\ folder.",
        "T1547.001::[Astaroth] creates a startup item for persistence.",
        "T1547.009::[Astaroth]'s initial payload is a malicious .LNK file.",
        "T1552::[Astaroth] uses an external software known as NetPass to recover passwords.",
        "T1555::[Astaroth] uses an external software known as NetPass to recover passwords.",
        "T1564.003::[Astaroth] loads its module with the XSL script parameter vShow set to zero, which opens the application with a hidden window.",
        "T1564.004::[Astaroth] can abuse alternate data streams (ADS) to store content for malicious payloads.",
        "T1568.002::[Astaroth] has used a DGA in C2 communications.",
        "T1574.001::[Astaroth] can launch itself via DLL Search Order Hijacking.",
        "T1598.002::[Astaroth] has been delivered via malicious e-mail attachments."
      ]
    },
    "description": "[Astaroth](https://attack.mitre.org/software/S0373) is a Trojan and information stealer known to affect companies in Europe, Brazil, and throughout Latin America. It has been known publicly since at least late 2017. (Citation: Cybereason Astaroth Feb 2019)(Citation: Cofense Astaroth Sept 2018)(Citation: Securelist Brazilian Banking Malware July 2020)"
  }
]

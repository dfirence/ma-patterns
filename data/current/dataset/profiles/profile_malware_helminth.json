[
  {
    "id": "malware--eff1a885-6f90-42a1-901f-eef6e7a1905e",
    "name": "helminth",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0170",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 21,
        "items": [
          "T1027",
          "T1030",
          "T1053.005",
          "T1056.001",
          "T1057",
          "T1059.001",
          "T1059.003",
          "T1059.005",
          "T1069.001",
          "T1069.002",
          "T1071.001",
          "T1071.004",
          "T1074.001",
          "T1105",
          "T1115",
          "T1119",
          "T1132.001",
          "T1547.001",
          "T1547.009",
          "T1553.002",
          "T1573.001"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "oilrig"
        ]
      },
      "procedures": [
        "T1027::The [Helminth] config file is encrypted with RC4.",
        "T1030::[Helminth] splits data into chunks up to 23 bytes and sends the data in DNS queries to its C2 server.",
        "T1053.005::[Helminth] has used a scheduled task for persistence.",
        "T1056.001::The executable version of [Helminth] has a module to log keystrokes.",
        "T1057::[Helminth] has used [Tasklist] to get information on processes.",
        "T1059.001::One version of [Helminth] uses a PowerShell script.",
        "T1059.003::[Helminth] can provide a remote shell. One version of [Helminth] uses batch scripting.",
        "T1059.005::One version of [Helminth] consists of VBScript scripts.",
        "T1069.001::[Helminth] has checked the local administrators group.",
        "T1069.002::[Helminth] has checked for the domain admin group and Exchange Trusted Subsystem groups using the commands net group Exchange Trusted Subsystem /domain and net group domain admins /domain.",
        "T1071.001::[Helminth] can use HTTP for C2.",
        "T1071.004::[Helminth] can use DNS for C2.",
        "T1074.001::[Helminth] creates folders to store output from batch scripts prior to sending the information to its C2 server.",
        "T1105::[Helminth] can download additional files.",
        "T1115::The executable version of [Helminth] has a module to log clipboard contents.",
        "T1119::A [Helminth] VBScript receives a batch script to execute a set of commands in a command prompt.",
        "T1132.001::For C2 over HTTP, [Helminth] encodes data with base64 and sends it via the \"Cookie\" field of HTTP requests. For C2 over DNS, [Helminth] converts ASCII characters into their hexadecimal values and sends the data in cleartext.",
        "T1547.001::[Helminth] establishes persistence by creating a shortcut in the Start Menu folder.",
        "T1547.009::[Helminth] establishes persistence by creating a shortcut.",
        "T1553.002::[Helminth] samples have been signed with legitimate, compromised code signing certificates owned by software company AI Squared.",
        "T1573.001::[Helminth] encrypts data sent to its C2 server over HTTP with RC4."
      ]
    },
    "description": "[Helminth](https://attack.mitre.org/software/S0170) is a backdoor that has at least two variants - one written in VBScript and PowerShell that is delivered via a macros in Excel spreadsheets, and one that is a standalone Windows executable. (Citation: Palo Alto OilRig May 2016)"
  }
]

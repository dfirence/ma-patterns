[
  {
    "id": "malware--bdee9574-7479-4073-a7dc-e86d8acd073a",
    "name": "macma",
    "aliases": "none",
    "platforms": "macos",
    "malware_id": "S1016",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "lateral-movement",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 25,
        "items": [
          "T1005",
          "T1016",
          "T1021",
          "T1033",
          "T1041",
          "T1056.001",
          "T1057",
          "T1059.004",
          "T1070.002",
          "T1070.004",
          "T1070.006",
          "T1074.001",
          "T1082",
          "T1083",
          "T1095",
          "T1105",
          "T1106",
          "T1113",
          "T1123",
          "T1140",
          "T1543.001",
          "T1553.001",
          "T1555.001",
          "T1571",
          "T1573"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1005::[MacMa] can collect then exfiltrate files from the compromised system.",
        "T1016::[MacMa] can collect IP addresses from a compromised host.",
        "T1021::[MacMa] can manage remote screen sessions.",
        "T1033::[MacMa] can collect the username from the compromised machine.",
        "T1041::[MacMa] exfiltrates data from a supplied path over its C2 channel.",
        "T1056.001::[MacMa] can use Core Graphics Event Taps to intercept user keystrokes from any text input field and saves them to text files. Text input fields include Spotlight, Finder, Safari, Mail, Messages, and other apps that have text fields for passwords.",
        "T1057::[MacMa] can enumerate running processes.",
        "T1059.004::[MacMa] can execute supplied shell commands and uses bash scripts to perform additional actions.",
        "T1070.002::[MacMa] can clear possible malware traces such as application logs.",
        "T1070.004::[MacMa] can delete itself from the compromised computer.",
        "T1070.006::[MacMa] has the capability to create and modify file timestamps.",
        "T1074.001::[MacMa] has stored collected files locally before exfiltration.",
        "T1082::[MacMa] can collect information about a compromised computer, including: Hardware UUID, Mac serial number, macOS version, and disk sizes.",
        "T1083::[MacMa] can search for a specific file on the compromised computer and can enumerate files in Desktop, Downloads, and Documents folders.",
        "T1095::[MacMa] has used a custom JSON-based protocol for its C&C communications.",
        "T1105::[MacMa] has downloaded additional files, including an exploit for used privilege escalation.",
        "T1106::[MacMa] has used macOS API functions to perform tasks.",
        "T1113::[MacMa] has used Appleâ€™s Core Graphic APIs, such as `CGWindowListCreateImageFromArray`, to capture the user's screen and open windows.",
        "T1123::[MacMa] has the ability to record audio.",
        "T1140::[MacMa] decrypts a downloaded file using AES-128-EBC with a custom delta.",
        "T1543.001::[MacMa] installs a `com.apple.softwareupdate.plist` file in the `/LaunchAgents` folder with the `RunAtLoad` value set to `true`. Upon user login, [MacMa] is executed from `/var/root/.local/softwareupdate` with root privileges. Some variations also include the `LimitLoadToSessionType` key with the value `Aqua`, ensuring the [MacMa] only runs when there is a logged in GUI user.",
        "T1553.001::[MacMa] has removed the `com.apple.quarantineattribute` from the dropped file, `$TMPDIR/airportpaird`.",
        "T1555.001::[MacMa] can dump credentials from the macOS keychain.",
        "T1571::[MacMa] has used TCP port 5633 for C2 Communication.",
        "T1573::[MacMa] has used TLS encryption to initialize a custom protocol for C2 communications."
      ]
    },
    "description": "[MacMa](https://attack.mitre.org/software/S1016) is a macOS-based backdoor with a large set of functionalities to control and exfiltrate files from a compromised computer. [MacMa](https://attack.mitre.org/software/S1016) has been observed in the wild since November 2021.(Citation: ESET DazzleSpy Jan 2022)"
  }
]

[
  {
    "id": "malware--59a97b15-8189-4d51-9404-e1ce8ea4a069",
    "name": "xagentosx",
    "aliases": "none",
    "platforms": "macos",
    "malware_id": "S0161",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution"
        ]
      },
      "techniques": {
        "count": 10,
        "items": [
          "T1033",
          "T1056.001",
          "T1057",
          "T1070.004",
          "T1071.002",
          "T1082",
          "T1083",
          "T1106",
          "T1113",
          "T1555.003"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "apt28"
        ]
      },
      "procedures": [
        "T1033::[XAgentOSX] contains the getInfoOSX function to return the OS X version as well as the current user.",
        "T1056.001::[XAgentOSX] contains keylogging functionality that will monitor for active application windows and write them to the log, it can handle special characters, and it will buffer by default 50 characters before sending them out over the C2 infrastructure.",
        "T1057::[XAgentOSX] contains the getProcessList function to run ps aux to get running processes.",
        "T1070.004::[XAgentOSX] contains the deletFileFromPath function to delete a specified file using the NSFileManager:removeFileAtPath method.",
        "T1071.002::[XAgentOSX] contains the ftpUpload function to use the FTPManager:uploadFile method to upload files from the target system.",
        "T1082::[XAgentOSX] contains the getInstalledAPP function to run ls -la /Applications to gather what applications are installed.",
        "T1083::[XAgentOSX] contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory.",
        "T1106::[XAgentOSX] contains the execFile function to execute a specified file on the system using the NSTask:launch method.",
        "T1113::[XAgentOSX] contains the takeScreenShot (along with startTakeScreenShot and stopTakeScreenShot) functions to take screenshots using the CGGetActiveDisplayList, CGDisplayCreateImage, and NSImage:initWithCGImage methods.",
        "T1555.003::[XAgentOSX] contains the getFirefoxPassword function to attempt to locate Firefox passwords."
      ]
    },
    "description": "[XAgentOSX](https://attack.mitre.org/software/S0161) is a trojan that has been used by [APT28](https://attack.mitre.org/groups/G0007)  on OS X and appears to be a port of their standard [CHOPSTICK](https://attack.mitre.org/software/S0023) or XAgent trojan. (Citation: XAgentOSX 2017)"
  }
]

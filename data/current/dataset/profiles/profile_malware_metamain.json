[
  {
    "id": "malware--df350889-4de9-44e5-8cb3-888b8343e97c",
    "name": "metamain",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S1059",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 9,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 28,
        "items": [
          "T1005",
          "T1027",
          "T1033",
          "T1041",
          "T1055",
          "T1056",
          "T1056.001",
          "T1057",
          "T1070.004",
          "T1070.006",
          "T1071.001",
          "T1074.001",
          "T1082",
          "T1083",
          "T1090.001",
          "T1095",
          "T1105",
          "T1106",
          "T1112",
          "T1113",
          "T1140",
          "T1205.001",
          "T1497.003",
          "T1546.003",
          "T1560.003",
          "T1573.001",
          "T1574.002",
          "T1620"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "metador"
        ]
      },
      "procedures": [
        "T1005::[metaMain] can collect files and system information from a compromised host.",
        "T1027::[metaMain]'s module file has been encrypted via XOR.",
        "T1033::[metaMain] can collect the username from a compromised host.",
        "T1041::[metaMain] can upload collected files and data to its C2 server.",
        "T1055::[metaMain] can inject the loader file, Speech02.db, into a process.",
        "T1056.001::[metaMain] has the ability to log keyboard events.",
        "T1056::[metaMain] can log mouse events.",
        "T1057::[metaMain] can enumerate the processes that run on the platform.",
        "T1070.004::[metaMain] has deleted collected items after uploading the content to its C2 server.",
        "T1070.006::[metaMain] can change the `CreationTime`, `LastAccessTime`, and `LastWriteTime` file time attributes when executed with `SYSTEM` privileges.",
        "T1071.001::[metaMain] can use HTTP for C2 communications.",
        "T1074.001::[metaMain] has stored the collected system files in a working directory.",
        "T1082::[metaMain] can collect the computer name from a compromised host.",
        "T1083::[metaMain] can recursively enumerate files in an operator-provided directory.",
        "T1090.001::[metaMain] can create a named pipe to listen for and send data to a named pipe-based C2 server.",
        "T1095::[metaMain] can establish an indirect and raw TCP socket-based connection to the C2 server.",
        "T1105::[metaMain] can download files onto compromised systems.",
        "T1106::[metaMain] can execute an operator-provided Windows command by leveraging functions such as `WinExec`, `WriteFile`, and `ReadFile`.",
        "T1112::[metaMain] can write the process ID of a target process into the `HKEY_LOCAL_MACHINE\\SOFTWARE\\DDE\\tpid` Registry value as part of its reflective loading activity.",
        "T1113::[metaMain] can take and save screenshots.",
        "T1140::[metaMain] can decrypt and load other modules.",
        "T1205.001::[metaMain] has authenticated itself to a different implant, Cryshell, through a port knocking and handshake procedure.",
        "T1497.003::[metaMain] has delayed execution for five to six minutes during its persistence establishment process.",
        "T1546.003::[metaMain] registered a WMI event subscription consumer called \"hard_disk_stat\" to establish persistence.",
        "T1560.003::[metaMain] has used XOR-based encryption for collected files before exfiltration.",
        "T1573.001::[metaMain] can encrypt the data that it sends and receives from the C2 server using an RC4 encryption algorithm.",
        "T1574.002::[metaMain] can support an HKCMD sideloading start method.",
        "T1620::[metaMain] has reflectively loaded a DLL to read, decrypt, and load an orchestrator file."
      ]
    },
    "description": "[metaMain](https://attack.mitre.org/software/S1059) is a backdoor used by [Metador](https://attack.mitre.org/groups/G1013) to maintain long-term access to compromised machines; it has also been used to decrypt [Mafalda](https://attack.mitre.org/software/S1060) into memory.(Citation: SentinelLabs Metador Sept 2022)(Citation: SentinelLabs Metador Technical Appendix Sept 2022)"
  }
]

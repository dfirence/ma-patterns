[
  {
    "id": "malware--7e6c2a9d-9dc1-4eb0-b27c-91e8076a9d77",
    "name": "quadagent",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0269",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 17,
        "items": [
          "T1008",
          "T1012",
          "T1016",
          "T1027.010",
          "T1027.011",
          "T1033",
          "T1036.005",
          "T1053.005",
          "T1059.001",
          "T1059.003",
          "T1059.005",
          "T1070.004",
          "T1071.001",
          "T1071.004",
          "T1112",
          "T1132.001",
          "T1140"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "oilrig"
        ]
      },
      "procedures": [
        "T1008::[QUADAGENT] uses multiple protocols (HTTPS, HTTP, DNS) for its C2 server as fallback channels if communication with one is unsuccessful.",
        "T1012::[QUADAGENT] checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.",
        "T1016::[QUADAGENT] gathers the current domain the victim system belongs to.",
        "T1027.010::[QUADAGENT] was likely obfuscated using `Invoke-Obfuscation`.",
        "T1027.011::[QUADAGENT] stores a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications within a Registry key (such as `HKCU\\Office365DCOMCheck`) in the `HKCU` hive.",
        "T1033::[QUADAGENT] gathers the victim username.",
        "T1036.005::[QUADAGENT] used the PowerShell filenames Office365DCOMCheck.ps1 and SystemDiskClean.ps1.",
        "T1053.005::[QUADAGENT] creates a scheduled task to maintain persistence on the victim’s machine.",
        "T1059.001::[QUADAGENT] uses PowerShell scripts for execution.",
        "T1059.003::[QUADAGENT] uses cmd.exe to execute scripts and commands on the victim’s machine.",
        "T1059.005::[QUADAGENT] uses VBScripts.",
        "T1070.004::[QUADAGENT] has a command to delete its Registry key and scheduled task.",
        "T1071.001::[QUADAGENT] uses HTTPS and HTTP for C2 communications.",
        "T1071.004::[QUADAGENT] uses DNS for C2 communications.",
        "T1112::[QUADAGENT] modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.",
        "T1132.001::[QUADAGENT] encodes C2 communications with base64.",
        "T1140::[QUADAGENT] uses AES and a preshared key to decrypt the custom Base64 routine used to encode strings and scripts."
      ]
    },
    "description": "[QUADAGENT](https://attack.mitre.org/software/S0269) is a PowerShell backdoor used by [OilRig](https://attack.mitre.org/groups/G0049). (Citation: Unit 42 QUADAGENT July 2018)"
  }
]

[
  {
    "id": "malware--727afb95-3d0f-4451-b297-362a43909923",
    "name": "thiefquest",
    "aliases": "none",
    "platforms": "macos",
    "malware_id": "S0595",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 10,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "impact",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 18,
        "items": [
          "T1036.005",
          "T1041",
          "T1056.001",
          "T1057",
          "T1059.002",
          "T1071.001",
          "T1105",
          "T1106",
          "T1486",
          "T1497.003",
          "T1518.001",
          "T1543.001",
          "T1543.004",
          "T1554",
          "T1562.001",
          "T1564.001",
          "T1620",
          "T1622"
        ]
      },
      "adversaries": {
        "count": 0,
        "items": []
      },
      "procedures": [
        "T1036.005::[ThiefQuest] prepends a copy of itself to the beginning of an executable file while maintaining the name of the executable.",
        "T1041::[ThiefQuest] exfiltrates targeted file extensions in the /Users/ folder to the command and control server via unencrypted HTTP. Network packets contain a string with two pieces of information: a file path and the contents of the file in a base64 encoded string.",
        "T1056.001::[ThiefQuest] uses the CGEventTap functions to perform keylogging.",
        "T1057::[ThiefQuest] obtains a list of running processes using the function kill_unwanted.",
        "T1059.002::[ThiefQuest] uses [AppleScript]'s osascript -e command to launch [ThiefQuest]'s persistence via [Launch Agent] and [Launch Daemon].",
        "T1071.001::[ThiefQuest] uploads files via unencrypted HTTP.",
        "T1105::[ThiefQuest] can download and execute payloads in-memory or from disk.",
        "T1106::[ThiefQuest] uses various API to perform behaviors such as executing payloads and performing local enumeration.",
        "T1486::[ThiefQuest] encrypts a set of file extensions on a host, deletes the original files, and provides a ransom note with no contact information.",
        "T1497.003::[ThiefQuest] invokes time call to check the system's time, executes a sleep command, invokes a second time call, and then compares the time difference between the two time calls and the amount of time the system slept to identify the sandbox.",
        "T1518.001::[ThiefQuest] uses the kill_unwanted function to get a list of running processes, compares each process with an encrypted list of “unwanted” security related programs, and kills the processes for security related programs.",
        "T1543.001::[ThiefQuest] installs a launch item using an embedded encrypted launch agent property list template. The plist file is installed in the ~/Library/LaunchAgents/ folder and configured with the path to the persistent binary located in the ~/Library/ folder.",
        "T1543.004::When running with root privileges after a [Launch Agent] is installed, [ThiefQuest] installs a plist file to the /Library/LaunchDaemons/ folder with the RunAtLoad key set to true establishing persistence as a Launch Daemon.",
        "T1554::[ThiefQuest] searches through the /Users/ folder looking for executable files. For each executable, [ThiefQuest] prepends a copy of itself to the beginning of the file. When the file is executed, the [ThiefQuest] code is executed first. [ThiefQuest] creates a hidden file, copies the original target executable to the file, then executes the new hidden file to maintain the appearance of normal behavior.",
        "T1562.001::[ThiefQuest] uses the function kill_unwanted to obtain a list of running processes and kills each process matching a list of security related processes.",
        "T1564.001::[ThiefQuest] hides a copy of itself in the user's ~/Library directory by using a . at the beginning of the file name followed by 9 random characters.",
        "T1620::[ThiefQuest] uses various API functions such as NSCreateObjectFileImageFromMemory to load and link in-memory payloads.",
        "T1622::[ThiefQuest] uses a function named is_debugging to perform anti-debugging logic. The function invokes sysctl checking the returned value of P_TRACED. [ThiefQuest] also calls ptrace with the PTRACE_DENY_ATTACH flag to prevent debugging."
      ]
    },
    "description": "[ThiefQuest](https://attack.mitre.org/software/S0595) is a virus, data stealer, and wiper that presents itself as ransomware targeting macOS systems. [ThiefQuest](https://attack.mitre.org/software/S0595) was first seen in 2020 distributed via trojanized pirated versions of popular macOS software on Russian forums sharing torrent links.(Citation: Reed thiefquest fake ransom) Even though [ThiefQuest](https://attack.mitre.org/software/S0595) presents itself as ransomware, since the dynamically generated encryption key is never sent to the attacker it may be more appropriately thought of as a form of wiper malware.(Citation: wardle evilquest partii)(Citation: reed thiefquest ransomware analysis)"
  }
]

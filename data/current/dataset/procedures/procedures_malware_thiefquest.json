[
  [
    "thiefquest",
    "T1036.005",
    "Match Legitimate Name or Location",
    "file-metadata|image-metadata|process-metadata",
    "T1036.005::[ThiefQuest] prepends a copy of itself to the beginning of an executable file while maintaining the name of the executable."
  ],
  [
    "thiefquest",
    "T1056.001",
    "Keylogging",
    "driver-load|os-api-execution|windows-registry-key-modification",
    "T1056.001::[ThiefQuest] uses the CGEventTap functions to perform keylogging."
  ],
  [
    "thiefquest",
    "T1059.002",
    "AppleScript",
    "command-execution|os-api-execution|process-creation",
    "T1059.002::[ThiefQuest] uses [AppleScript]'s osascript -e command to launch [ThiefQuest]'s persistence via [Launch Agent] and [Launch Daemon]."
  ],
  [
    "thiefquest",
    "T1071.001",
    "Web Protocols",
    "network-traffic-content|network-traffic-flow",
    "T1071.001::[ThiefQuest] uploads files via unencrypted HTTP."
  ],
  [
    "thiefquest",
    "T1497.003",
    "Time Based Evasion",
    "command-execution|os-api-execution|process-creation",
    "T1497.003::[ThiefQuest] invokes time call to check the system's time, executes a sleep command, invokes a second time call, and then compares the time difference between the two time calls and the amount of time the system slept to identify the sandbox."
  ],
  [
    "thiefquest",
    "T1518.001",
    "Security Software Discovery",
    "command-execution|firewall-enumeration|firewall-metadata|os-api-execution|process-creation",
    "T1518.001::[ThiefQuest] uses the kill_unwanted function to get a list of running processes, compares each process with an encrypted list of “unwanted” security related programs, and kills the processes for security related programs."
  ],
  [
    "thiefquest",
    "T1543.001",
    "Launch Agent",
    "command-execution|file-creation|file-modification|service-creation|service-modification",
    "T1543.001::[ThiefQuest] installs a launch item using an embedded encrypted launch agent property list template. The plist file is installed in the ~/Library/LaunchAgents/ folder and configured with the path to the persistent binary located in the ~/Library/ folder."
  ],
  [
    "thiefquest",
    "T1543.004",
    "Launch Daemon",
    "command-execution|file-creation|file-modification|process-creation|service-creation|service-modification",
    "T1543.004::When running with root privileges after a [Launch Agent] is installed, [ThiefQuest] installs a plist file to the /Library/LaunchDaemons/ folder with the RunAtLoad key set to true establishing persistence as a Launch Daemon."
  ],
  [
    "thiefquest",
    "T1562.001",
    "Disable or Modify Tools",
    "command-execution|driver-load|host-status|process-termination|service-metadata|windows-registry-key-deletion|windows-registry-key-modification",
    "T1562.001::[ThiefQuest] uses the function kill_unwanted to obtain a list of running processes and kills each process matching a list of security related processes."
  ],
  [
    "thiefquest",
    "T1564.001",
    "Hidden Files and Directories",
    "command-execution|file-creation|file-metadata|process-creation",
    "T1564.001::[ThiefQuest] hides a copy of itself in the user's ~/Library directory by using a . at the beginning of the file name followed by 9 random characters."
  ]
]

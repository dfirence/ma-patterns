[
  [
    "xcsset",
    "T1056.002",
    "GUI Input Capture",
    "command-execution|process-creation|script-execution",
    "T1056.002::[XCSSET] prompts the user to input credentials using a native macOS dialog box leveraging the system process /Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment."
  ],
  [
    "xcsset",
    "T1059.004",
    "Unix Shell",
    "command-execution|process-creation",
    "T1059.004::[XCSSET] uses a shell script to execute Mach-o files and osacompile commands such as, osacompile -x -o xcode.app main.applescript."
  ],
  [
    "xcsset",
    "T1098.004",
    "SSH Authorized Keys",
    "command-execution|file-modification|process-creation",
    "T1098.004::[XCSSET] will create an ssh key if necessary with the ssh-keygen -t rsa -f $HOME/.ssh/id_rsa -P command. [XCSSET] will upload a private key file to the server to remotely access the host without a password."
  ],
  [
    "xcsset",
    "T1195.001",
    "Compromise Software Dependencies and Development Tools",
    "file-metadata",
    "T1195.001::[XCSSET] adds malicious code to a host's Xcode projects by enumerating CocoaPods target_integrator.rb files under the /Library/Ruby/Gems folder or enumerates all .xcodeproj folders under a given directory. [XCSSET] then downloads a script and Mach-O file into the Xcode project folder."
  ],
  [
    "xcsset",
    "T1222.002",
    "Linux and Mac File and Directory Permissions Modification",
    "command-execution|file-metadata|process-creation",
    "T1222.002::[XCSSET] uses the chmod +x command to grant executable permissions to the malicious file."
  ],
  [
    "xcsset",
    "T1497.003",
    "Time Based Evasion",
    "command-execution|os-api-execution|process-creation",
    "T1497.003::Using the machine's local time, [XCSSET] waits 43200 seconds (12 hours) from the initial creation timestamp of a specific file, .report. After the elapsed time, [XCSSET] executes additional modules."
  ],
  [
    "xcsset",
    "T1518.001",
    "Security Software Discovery",
    "command-execution|firewall-enumeration|firewall-metadata|os-api-execution|process-creation",
    "T1518.001::[XCSSET] searches firewall configuration files located in /Library/Preferences/ and uses csrutil status to determine if System Integrity Protection is enabled."
  ],
  [
    "xcsset",
    "T1543.004",
    "Launch Daemon",
    "command-execution|file-creation|file-modification|process-creation|service-creation|service-modification",
    "T1543.004::[XCSSET] uses the ssh launchdaemon to elevate privileges, bypass system controls, and enable remote access to the victim."
  ],
  [
    "xcsset",
    "T1553.001",
    "Gatekeeper Bypass",
    "command-execution|file-metadata|file-modification|process-creation",
    "T1553.001::[XCSSET] has dropped a malicious applet into an app's `.../Contents/MacOS/` folder of a previously launched app to bypass Gatekeeper's security checks on first launch apps (prior to macOS 13)."
  ],
  [
    "xcsset",
    "T1564.001",
    "Hidden Files and Directories",
    "command-execution|file-creation|file-metadata|process-creation",
    "T1564.001::[XCSSET] uses a hidden folder named .xcassets and .git to embed itself in Xcode."
  ],
  [
    "xcsset",
    "T1569.001",
    "Launchctl",
    "command-execution|file-modification|process-creation|service-creation",
    "T1569.001::[XCSSET] loads a system level launchdaemon using the launchctl load -w command from /System/Librarby/LaunchDaemons/ssh.plist."
  ],
  [
    "xcsset",
    "T1573.001",
    "Symmetric Cryptography",
    "network-traffic-content",
    "T1573.001::[XCSSET] uses RC4 encryption over TCP to communicate with its C2 server."
  ],
  [
    "xcsset",
    "T1574.006",
    "Dynamic Linker Hijacking",
    "command-execution|file-creation|file-modification|module-load|process-creation",
    "T1574.006::[XCSSET] adds malicious file paths to the DYLD_FRAMEWORK_PATH and DYLD_LIBRARY_PATH environment variables to execute malicious code."
  ],
  [
    "xcsset",
    "T1614.001",
    "System Language Discovery",
    "command-execution|os-api-execution|process-creation|windows-registry-key-access",
    "T1614.001::[XCSSET] uses AppleScript to check the host's language and location with the command user locale of (get system info)."
  ]
]

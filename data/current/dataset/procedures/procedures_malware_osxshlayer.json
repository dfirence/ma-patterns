[
  [
    "osxshlayer",
    "T1036.005",
    "Match Legitimate Name or Location",
    "file-metadata|image-metadata|process-metadata",
    "T1036.005::[OSX/Shlayer] can masquerade as a Flash Player update."
  ],
  [
    "osxshlayer",
    "T1059.004",
    "Unix Shell",
    "command-execution|process-creation",
    "T1059.004::[OSX/Shlayer] can use bash scripts to check the macOS version, download payloads, and extract bytes from files. [OSX/Shlayer] uses the command sh -c tail -c +1381... to extract bytes at an offset from a specified file. [OSX/Shlayer] uses the curl -fsL \"$url\" >$tmp_path command to download malicious payloads into a temporary directory."
  ],
  [
    "osxshlayer",
    "T1204.002",
    "Malicious File",
    "file-creation|process-creation",
    "T1204.002::[OSX/Shlayer] has relied on users mounting and executing a malicious DMG file."
  ],
  [
    "osxshlayer",
    "T1222.002",
    "Linux and Mac File and Directory Permissions Modification",
    "command-execution|file-metadata|process-creation",
    "T1222.002::[OSX/Shlayer] can use the chmod utility to set a file as executable, such as chmod 777 or chmod +x."
  ],
  [
    "osxshlayer",
    "T1548.004",
    "Elevated Execution with Prompt",
    "os-api-execution|process-creation",
    "T1548.004::[OSX/Shlayer] can escalate privileges to root by asking the user for credentials."
  ],
  [
    "osxshlayer",
    "T1553.001",
    "Gatekeeper Bypass",
    "command-execution|file-metadata|file-modification|process-creation",
    "T1553.001::If running with elevated privileges, [OSX/Shlayer] has used the spctl command to disable Gatekeeper protection for a downloaded file. [OSX/Shlayer] can also leverage system links pointing to bash scripts in the downloaded DMG file to bypass Gatekeeper, a flaw patched in macOS 11.3 and later versions. [OSX/Shlayer] has been Notarized by Apple, resulting in successful passing of additional Gatekeeper checks."
  ],
  [
    "osxshlayer",
    "T1564.001",
    "Hidden Files and Directories",
    "command-execution|file-creation|file-metadata|process-creation",
    "T1564.001::[OSX/Shlayer] has executed a .command script from a hidden directory in a mounted DMG."
  ],
  [
    "osxshlayer",
    "T1564.009",
    "Resource Forking",
    "command-execution|file-creation|file-metadata|process-creation",
    "T1564.009::[OSX/Shlayer] has used a resource fork to hide a compressed binary file of itself from the terminal, Finder, and potentially evade traditional scanners."
  ]
]

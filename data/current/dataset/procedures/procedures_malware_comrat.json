[
  [
    "comrat",
    "T1027.009",
    "Embedded Payloads",
    "file-creation|file-metadata",
    "T1027.009::[ComRAT] has embedded a XOR encrypted communications module inside the orchestrator module."
  ],
  [
    "comrat",
    "T1027.010",
    "Command Obfuscation",
    "command-execution|file-metadata|script-execution",
    "T1027.010::[ComRAT] has used encryption and base64 to obfuscate its orchestrator code in the Registry. [ComRAT] has also used encoded PowerShell scripts."
  ],
  [
    "comrat",
    "T1027.011",
    "Fileless Storage",
    "windows-registry-key-creation|wmi-creation",
    "T1027.011::[ComRAT] has stored encrypted orchestrator code and payloads in the Registry."
  ],
  [
    "comrat",
    "T1036.004",
    "Masquerade Task or Service",
    "command-execution|scheduled-job-metadata|scheduled-job-modification|service-creation|service-metadata",
    "T1036.004::[ComRAT] has used a task name associated with Windows SQM Consolidator."
  ],
  [
    "comrat",
    "T1053.005",
    "Scheduled Task",
    "command-execution|file-modification|process-creation|scheduled-job-creation|windows-registry-key-creation",
    "T1053.005::[ComRAT] has used a scheduled task to launch its PowerShell loader."
  ],
  [
    "comrat",
    "T1055.001",
    "Dynamic-link Library Injection",
    "module-load|os-api-execution|process-access|process-metadata|process-modification",
    "T1055.001::[ComRAT] has injected its orchestrator DLL into explorer.exe. [ComRAT] has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process."
  ],
  [
    "comrat",
    "T1059.001",
    "PowerShell",
    "command-execution|module-load|process-creation|process-metadata|script-execution",
    "T1059.001::[ComRAT] has used PowerShell to load itself every time a user logs in to the system. [ComRAT] can execute PowerShell scripts loaded into memory or from the file system."
  ],
  [
    "comrat",
    "T1059.003",
    "Windows Command Shell",
    "command-execution|process-creation",
    "T1059.003::[ComRAT] has used cmd.exe to execute commands."
  ],
  [
    "comrat",
    "T1071.001",
    "Web Protocols",
    "network-traffic-content|network-traffic-flow",
    "T1071.001::[ComRAT] has used HTTP requests for command and control."
  ],
  [
    "comrat",
    "T1071.003",
    "Mail Protocols",
    "network-traffic-content|network-traffic-flow",
    "T1071.003::[ComRAT] can use email attachments for command and control."
  ],
  [
    "comrat",
    "T1102.002",
    "Bidirectional Communication",
    "network-connection-creation|network-traffic-content|network-traffic-flow",
    "T1102.002::[ComRAT] has the ability to use the Gmail web UI to receive commands and exfiltrate information."
  ],
  [
    "comrat",
    "T1546.015",
    "Component Object Model Hijacking",
    "command-execution|module-load|process-creation|windows-registry-key-modification",
    "T1546.015::[ComRAT] samples have been seen which hijack COM objects for persistence by replacing the path to shell32.dll in registry location HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32."
  ],
  [
    "comrat",
    "T1564.005",
    "Hidden File System",
    "file-modification|firmware-modification|windows-registry-key-modification",
    "T1564.005::[ComRAT] has used a portable FAT16 partition image placed in %TEMP% as a hidden file system."
  ],
  [
    "comrat",
    "T1573.002",
    "Asymmetric Cryptography",
    "network-traffic-content",
    "T1573.002::[ComRAT] can use SSL/TLS encryption for its HTTP-based C2 channel. [ComRAT] has used public key cryptography with RSA and AES encrypted email attachments for its Gmail C2 channel."
  ]
]

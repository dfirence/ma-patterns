[
  {
    "id": "malware--da5880b4-f7da-4869-85f2-e0aba84b8565",
    "name": "comrat",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0126",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 7,
        "items": [
          "command-and-control",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 20,
        "items": [
          "T1012",
          "T1027",
          "T1027.009",
          "T1029",
          "T1036.004",
          "T1053.005",
          "T1055.001",
          "T1059.001",
          "T1059.003",
          "T1071.001",
          "T1071.003",
          "T1102.002",
          "T1106",
          "T1112",
          "T1124",
          "T1140",
          "T1518",
          "T1546.015",
          "T1564.005",
          "T1573.002"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "turla"
        ]
      },
      "procedures": [
        "T1012::[ComRAT] can check the default browser by querying HKCR\\http\\shell\\open\\command.",
        "T1027.009::[ComRAT] has embedded a XOR encrypted communications module inside the orchestrator module.",
        "T1027::[ComRAT] has used encryption and base64 to obfuscate its orchestrator code in the Registry. [ComRAT] has encrypted its virtual file system using AES-256 in XTS mode and has encoded PowerShell scripts.",
        "T1029::[ComRAT] has been programmed to sleep outside local business hours (9 to 5, Monday to Friday).",
        "T1036.004::[ComRAT] has used a task name associated with Windows SQM Consolidator.",
        "T1053.005::[ComRAT] has used a scheduled task to launch its PowerShell loader.",
        "T1055.001::[ComRAT] has injected its orchestrator DLL into explorer.exe. [ComRAT] has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process.",
        "T1059.001::[ComRAT] has used PowerShell to load itself every time a user logs in to the system. [ComRAT] can execute PowerShell scripts loaded into memory or from the file system.",
        "T1059.003::[ComRAT] has used cmd.exe to execute commands.",
        "T1071.001::[ComRAT] has used HTTP requests for command and control.",
        "T1071.003::[ComRAT] can use email attachments for command and control.",
        "T1102.002::[ComRAT] has the ability to use the Gmail web UI to receive commands and exfiltrate information.",
        "T1106::[ComRAT] can load a PE file from memory or the file system and execute it with CreateProcessW.",
        "T1112::[ComRAT] has encrypted and stored its orchestrator code in the Registry as well as a PowerShell script into the WsqmCons Registry key.",
        "T1124::[ComRAT] has checked the victim system's date and time to perform tasks during business hours (9 to 5, Monday to Friday).",
        "T1140::[ComRAT] has used unique per machine passwords to decrypt the orchestrator payload and a hardcoded XOR key to decrypt its communications module. [ComRAT] has also used a unique password to decrypt the file used for its hidden file system.",
        "T1518::[ComRAT] can check the victim's default browser to determine which process to inject its communications module into.",
        "T1546.015::[ComRAT] samples have been seen which hijack COM objects for persistence by replacing the path to shell32.dll in registry location HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32.",
        "T1564.005::[ComRAT] has used a portable FAT16 partition image placed in %TEMP% as a hidden file system.",
        "T1573.002::[ComRAT] can use SSL/TLS encryption for its HTTP-based C2 channel. [ComRAT] has used public key cryptography with RSA and AES encrypted email attachments for its Gmail C2 channel."
      ]
    },
    "description": "[ComRAT](https://attack.mitre.org/software/S0126) is a second stage implant suspected of being a descendant of [Agent.btz](https://attack.mitre.org/software/S0092) and used by [Turla](https://attack.mitre.org/groups/G0010). The first version of [ComRAT](https://attack.mitre.org/software/S0126) was identified in 2007, but the tool has undergone substantial development for many years since.(Citation: Symantec Waterbug)(Citation: NorthSec 2015 GData Uroburos Tools)(Citation: ESET ComRAT May 2020)"
  }
]

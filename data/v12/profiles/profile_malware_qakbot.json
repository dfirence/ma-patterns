[
  {
    "id": "malware--edc5e045-5401-42bb-ad92-52b5b2ee0de9",
    "name": "qakbot",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0650",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 11,
        "items": [
          "collection",
          "command-and-control",
          "credential-access",
          "defense-evasion",
          "discovery",
          "execution",
          "exfiltration",
          "initial-access",
          "lateral-movement",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 64,
        "items": [
          "T1005",
          "T1010",
          "T1016",
          "T1016.001",
          "T1018",
          "T1027",
          "T1027.001",
          "T1027.002",
          "T1027.005",
          "T1033",
          "T1036",
          "T1041",
          "T1047",
          "T1049",
          "T1053.005",
          "T1055",
          "T1055.012",
          "T1056.001",
          "T1057",
          "T1059.001",
          "T1059.003",
          "T1059.005",
          "T1059.007",
          "T1069.001",
          "T1070.004",
          "T1071.001",
          "T1074.001",
          "T1082",
          "T1083",
          "T1090.002",
          "T1091",
          "T1095",
          "T1105",
          "T1106",
          "T1110",
          "T1112",
          "T1114.001",
          "T1120",
          "T1124",
          "T1132.001",
          "T1135",
          "T1140",
          "T1185",
          "T1204.001",
          "T1204.002",
          "T1210",
          "T1218.007",
          "T1218.010",
          "T1218.011",
          "T1482",
          "T1497.001",
          "T1497.003",
          "T1518",
          "T1518.001",
          "T1539",
          "T1547.001",
          "T1553.002",
          "T1555.003",
          "T1562.001",
          "T1566.001",
          "T1566.002",
          "T1568.002",
          "T1572",
          "T1573.001"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "ta551"
        ]
      },
      "procedures": [
        "T1005::[QakBot] can use a variety of commands, including esentutl.exe to steal sensitive data from Internet Explorer and Microsoft Edge, to acquire information that is subsequently exfiltrated.",
        "T1010::[QakBot] has the ability to enumerate windows on a compromised host.",
        "T1016.001::[QakBot] can measure the download speed on a targeted host.",
        "T1016::[QakBot] can use net config workstation, arp -a, and ipconfig /all to gather network configuration information.",
        "T1018::[QakBot] can identify remote systems through the net view command.",
        "T1027.001::[QakBot] can use large file sizes to evade detection.",
        "T1027.002::[QakBot] can encrypt and pack malicious payloads.",
        "T1027.005::[QakBot] can make small changes to itself in order to change its checksum and hash value.",
        "T1027::[QakBot] can use obfuscated and encoded scripts; it has also hidden code within Excel spreadsheets by turning the font color to white and splitting it across multiple cells.",
        "T1033::[QakBot] can identify the user name on a compromised system.",
        "T1036::The [QakBot] payload has been disguised as a PNG file.",
        "T1041::[QakBot] can send stolen information to C2 nodes including passwords, accounts, and emails.",
        "T1047::[QakBot] can execute WMI queries to gather information.",
        "T1049::[QakBot] can use netstat to enumerate current network connections.",
        "T1053.005::[QakBot] has the ability to create scheduled tasks for persistence.",
        "T1055.012::[QakBot] can use process hollowing to execute its main payload.",
        "T1055::[QakBot] can inject itself into processes including explore.exe, Iexplore.exe, and Mobsync.exe.",
        "T1056.001::[QakBot] can capture keystrokes on a compromised host.",
        "T1057::[QakBot] has the ability to check running processes.",
        "T1059.001::[QakBot] can use PowerShell to download and execute payloads.",
        "T1059.003::[QakBot] can use cmd.exe to launch itself and to execute multiple C2 commands.",
        "T1059.005::[QakBot] can use VBS to download and execute malicious files.",
        "T1059.007::The [QakBot] web inject module can inject Java Script into web banking pages visited by the victim.",
        "T1069.001::[QakBot] can use net localgroup to enable discovery of local groups.",
        "T1070.004::[QakBot] can delete folders and files including overwriting its executable with legitimate programs.",
        "T1071.001::[QakBot] has the ability to use HTTP and HTTPS in communication with C2 servers.",
        "T1074.001::[QakBot] has stored stolen emails and other data into new folders prior to exfiltration.",
        "T1082::[QakBot] can collect system information including the OS version and domain on a compromised host.",
        "T1083::[QakBot] can identify whether it has been run previously on a host by checking for a specified folder.",
        "T1090.002::[QakBot] has a module that can proxy C2 communications.",
        "T1091::[QakBot] has the ability to use removable drives to spread through compromised networks.",
        "T1095::[QakBot] has the ability use TCP to send or receive C2 packets.",
        "T1105::[QakBot] has the ability to download additional components and malware.",
        "T1106::[QakBot] can use GetProcAddress to help delete malicious strings from memory.",
        "T1110::[QakBot] can conduct brute force attacks to capture credentials.",
        "T1112::[QakBot] can store its configuration information in a randomly named subkey under HKCU\\Software\\Microsoft.",
        "T1114.001::[QakBot] can target and steal locally stored emails to support thread hijacking phishing campaigns.",
        "T1120::[QakBot] can identify peripheral devices on targeted systems.",
        "T1124::[QakBot] can identify the system time on a targeted host.",
        "T1132.001::[QakBot] can Base64 encode system information sent to C2.",
        "T1135::[QakBot] can use net share to identify network shares for use in lateral movement.",
        "T1140::[QakBot] can deobfuscate and re-assemble code strings for execution.",
        "T1185::[QakBot] can use advanced web injects to steal web banking credentials.",
        "T1204.001::[QakBot] has gained execution through users opening malicious links.",
        "T1204.002::[QakBot] has gained execution through users opening malicious attachments.",
        "T1210::[QakBot] can move laterally using worm-like functionality through exploitation of SMB.",
        "T1218.007::[QakBot] can use MSIExec to spawn multiple cmd.exe processes.",
        "T1218.010::[QakBot] can use Regsvr32 to execute malicious DLLs.",
        "T1218.011::[QakBot] can use Rundll32.exe to enable C2 communication.",
        "T1482::[QakBot] can run nltest /domain_trusts /all_trusts for domain trust discovery.",
        "T1497.001::[QakBot] can check the compromised host for the presence of multiple executables associated with analysis tools and halt execution if any are found.",
        "T1497.003::The [QakBot] dropper can delay dropping the payload to evade detection.",
        "T1518.001::[QakBot] can identify the installed antivirus product on a targeted system.",
        "T1518::[QakBot] can enumerate a list of installed programs.",
        "T1539::[QakBot] has the ability to capture web session cookies.",
        "T1547.001::[QakBot] can maintain persistence by creating an auto-run Registry key.",
        "T1553.002::[QakBot] can use signed loaders to evade detection.",
        "T1555.003::[QakBot] has collected usernames and passwords from Firefox and Chrome.",
        "T1562.001::[QakBot] has the ability to modify the Registry to add its binaries to the Windows Defender exclusion list.",
        "T1566.001::[QakBot] has spread through emails with malicious attachments.",
        "T1566.002::[QakBot] has spread through emails with malicious links.",
        "T1568.002::[QakBot] can use domain generation algorithms in C2 communication.",
        "T1572::The [QakBot] proxy module can encapsulate SOCKS5 protocol within its own proxy protocol.",
        "T1573.001::[QakBot] can RC4 encrypt strings in C2 communication."
      ]
    },
    "description": "[QakBot](https://attack.mitre.org/software/S0650) is a modular banking trojan that has been used primarily by financially-motivated actors since at least 2007. [QakBot](https://attack.mitre.org/software/S0650) is continuously maintained and developed and has evolved from an information stealer into a delivery agent for ransomware, most notably [ProLock](https://attack.mitre.org/software/S0654) and [Egregor](https://attack.mitre.org/software/S0554).(Citation: Trend Micro Qakbot December 2020)(Citation: Red Canary Qbot)(Citation: Kaspersky QakBot September 2021)(Citation: ATT QakBot April 2021)"
  }
]

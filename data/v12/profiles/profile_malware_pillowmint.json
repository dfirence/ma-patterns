[
  {
    "id": "malware--bd7a9e13-69fa-4243-a5e5-04326a63f9f2",
    "name": "pillowmint",
    "aliases": "none",
    "platforms": "windows",
    "malware_id": "S0517",
    "is_revoked": false,
    "profile": {
      "tactics": {
        "count": 6,
        "items": [
          "collection",
          "defense-evasion",
          "discovery",
          "execution",
          "persistence",
          "privilege-escalation"
        ]
      },
      "techniques": {
        "count": 13,
        "items": [
          "T1005",
          "T1012",
          "T1027",
          "T1055.004",
          "T1057",
          "T1059.001",
          "T1070.004",
          "T1070.009",
          "T1106",
          "T1112",
          "T1140",
          "T1546.011",
          "T1560"
        ]
      },
      "adversaries": {
        "count": 1,
        "items": [
          "fin7"
        ]
      },
      "procedures": [
        "T1005::[Pillowmint] has collected credit card data using native API functions.",
        "T1012::[Pillowmint] has used shellcode which reads code stored in the registry keys \\REGISTRY\\SOFTWARE\\Microsoft\\DRM using the native Windows API as well as read HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces as part of its C2.",
        "T1027::[Pillowmint] has been compressed and stored within a registry key. [Pillowmint] has also obfuscated the AES key used for encryption.",
        "T1055.004::[Pillowmint] has used the NtQueueApcThread syscall to inject code into svchost.exe.",
        "T1057::[Pillowmint] can iterate through running processes every six seconds collecting a list of processes to capture from later.",
        "T1059.001::[Pillowmint] has used a PowerShell script to install a shim database.",
        "T1070.004::[Pillowmint] has deleted the filepath %APPDATA%\\Intel\\devmonsrv.exe.",
        "T1070.009::[Pillowmint] can uninstall the malicious service from an infected machine.",
        "T1106::[Pillowmint] has used multiple native Windows APIs to execute and conduct process injections.",
        "T1112::[Pillowmint] has stored its malicious payload in the registry key HKLM\\SOFTWARE\\Microsoft\\DRM.",
        "T1140::[Pillowmint] has been decompressed by included shellcode prior to being launched.",
        "T1546.011::[Pillowmint] has used a malicious shim database to maintain persistence.",
        "T1560::[Pillowmint] has encrypted stolen credit card information with AES and further encoded it with Base64."
      ]
    },
    "description": "[Pillowmint](https://attack.mitre.org/software/S0517) is a point-of-sale malware used by [FIN7](https://attack.mitre.org/groups/G0046) designed to capture credit card information.(Citation: Trustwave Pillowmint June 2020)"
  }
]
